[{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/intro/","title":"Introduction","tags":[],"description":"Introduction","content":"What is the livechat plugin? This Peertube plugin is meant to provide a chat system for Peertube videos.\nBy default, once you have installed the plugin on your Peertube instance, a chat room will automatically be created for each live stream.\nOn the following screenshot, you can see a classic Peertube video page, with a chat room on the right (click on the picture to view it full screen):\nThe chat room will be accessible for all viewers, even those who don\u0026rsquo;t have an account on your instance. Those \u0026ldquo;anonymous\u0026rdquo; users just have to choose a nickname before they can begin talking in the chat.\nBy default, the chat is displayed next to the video. But you can open it in another browser tab, using the button on top of it :\nYou can test the livechat plugin with this demo page.\n Installation As a Peertube administrator, you can setup this plugin on your instance simply by using the Peertube plugin marketplace included in the administration interface. Search for \u0026ldquo;livechat\u0026rdquo;, then click \u0026ldquo;install\u0026rdquo;: that\u0026rsquo;s it!\nLivechat capabilities The plugin has many advanced features. As it is using the XMPP standard \u0026ldquo;under the hood\u0026rdquo;, it is possible for Peertube administrators to allow advanced usages (connection using XMPP clients, chatbots, bridge to other chat protocols, \u0026hellip;). More information in the relevant sections of this documentation.\nFederation Peertube is part of the fediverse: you can create a network of Peertube instances, sharing content between them.\nThis plugin can handle federation: when viewing a livestream from a remote instance, you will join the chat room with your local account. You will be automatically connected with your current nickname and avatar.\nOf course, for the federation to work, the plugin must be installed on both instances.\nModeration Some times, you have to protect your community from bad people. As an instance administrator, you can choose to disallow federation for the livechat plugin. If remote actors behave badly, streamers, moderators and administrators can ban or mute users.\nChat bot This plugin comes with a built-in chat bot. Check its documentation for more information.\nYou can also plug in any other XMPP chat bot, using XMPP External Components. To do so, you just have to configure External Components access in the plugin settings.\nChat persistence When joining a room, you will see previous messages. Even those sent before you joined the room.\nThis behaviour can be changed room by room, and default retention duration can be chosen by instance\u0026rsquo;s administrators.\nIntegrate the chat in your live stream When using software as OBS for you live stream, you can embed the chat in the video stream. This is for example useful for replays.\nIn the following screenshot, you can see a live replay, where the chat content is embeded on bottom of the video:\nIn the following screenshot, you can see an OBS setup, where the chat is included as a source in the current scene (background color can be changed, and can be transparent):\nOther usages By default, each streamer will be able to activate/deactivate the chat for their live streams.\nBut on the instance level, administrators can choose to activate the chat for all videos (live and/or VOD).\nYou can even activate the chat for specific VOD videos. This is how the demo page works: it is not a live stream, but I have activated the chat specifically for this video.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/contributing/codeofconduct/","title":"Code of Conduct","tags":[],"description":"Contributor Covenant Code of Conduct","content":" This Code of Conduct is adapted from the Contributor Covenant, version 2.1, available at https://www.contributor-covenant.org/version/2/1/code_of_conduct.html. Translations are available at https://www.contributor-covenant.org/translations. Instances of abusive, harassing, or otherwise unacceptable behavior may be reported to the community leaders responsible for enforcement by mail at git.[at].john-livingston.fr.\n SPDX-FileCopyrightText: 2024 John Livingston https://www.john-livingston.fr/\nSPDX-License-Identifier: AGPL-3.0-only\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/","title":"Documentation","tags":[],"description":"Plugin documentation","content":"  User documentation  Plugin peertube-plugin-livechat user documentation\n  For viewers  How to chat for stream viewers\n   OBS  Documentation to stream the chat content using OBS.\n   XMPP Clients  Connect to chat using a XMPP client\n   For streamers  How to setup the chat for your live stream\n  Some basics  Some basics about how to setup and use the chat for your live stream\n Channel configuration  Peertube channel chatrooms configuration\n Moderation  Plugin peertube-plugin-livechat advanced moderation features\n Terms \u0026amp; conditions  Configure channel\u0026#39;s chat terms \u0026amp; conditions\n Slow mode  Plugin peertube-plugin-livechat slow mode\n Moderation delay  Plugin peertube-plugin-livechat moderation delay\n Custom emojis  Plugin peertube-plugin-livechat custom emojis\n Polls  You can create polls to ask viewers their opinion.\n Tasks / To-do lists  You can handle tasks and task lists with your moderation team.\n Chat bot  Chat bot setup\n   Installation guide  Plugin peertube-plugin-livechat installation guide\n  Troubleshooting  Some classic mistakes and workarounds.\n   Known issues: CPU Compatibility  For now, the plugin only works out of the box for x86_64 and arm64 CPU architecture. Here are some instructions for other CPU architectures.\n   Upgrade from version older than 6.0.0  Important notes when upgrading for an older version.\n    Admin documentation  Plugin Peertube Livechat administration\n  Settings  Plugin Peertube Livechat settings\n   External Authentication  Plugin Peertube Livechat settings - External Authentication\n   Advanced usage  Some advanced features\n  XMPP clients  Allow connections using XMPP clients\n Using Matterbridge  Using Matterbridge to bridge with other chats\n   "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/viewers/","title":"For viewers","tags":[],"description":"How to chat for stream viewers","content":"Joining chat rooms When you are watching a Peertube video that has the chat activated, you will see the chat next to the video:\nThere are two slightly different use cases, depending on wether or not you have an account on the Peertube instance. See bellow for more informations.\nIf you haven\u0026rsquo;t a Peertube account This feature can be disabled by the instance\u0026rsquo;s adminitrators.\n If you are not logged in on the Peertube instance where you are watching the video, you will automatically join the chat. You will be assigned a random nickname (something like \u0026ldquo;Anonymous 12345\u0026rdquo;).\nBefore being able to speak in the chat room, you have to enter a nickname in the field on the bottom of the window.\nLog in using an external authentication provider This feature can be disabled by the instance\u0026rsquo;s adminitrators.\n The Peertube instance can configure external authentication providers (Mastodon accounts, Google accounts, \u0026hellip;). In such case, you will see a \u0026ldquo;Log in using an external account\u0026rdquo; button, that will open a dialog modal. In this dialog modal, there will be some buttons to connect using a remote account.\nOnce you signed in the remote account, and have granted access, your nickname and avatar (if available) will be automatically fetched. No other data will be stored. These data will be automatically deleted several hours after your quit the chat.\nIf you have a Peertube account If you are connected with your Peertube account, you will automatically join the room, using your Peertube nickname and avatar.\nIf you are watching a live on an instance on which you have no account, but you have an account on another instance: if the livechat plugin is installed on both instances, it is possible to join the chat using your account. To do so, just open the video on your instance (you can for example copy/paste the video url in the search field of your instance).\n If you have a Peertube account on another Peertube instance This feature comes with the livechat plugin version 9.0.0.\n If you have a Peertube account, but not on the current instance, there is a \u0026ldquo;Log in using an external account\u0026rdquo; button. This button will open a dialog where you can enter your Peertube instance URL. Once you entered it, it will check if the livechat plugin is available on the remote instance, and if the video is available. If it is the case, you will be redirected to the video on the remote instance.\nChatting To send messages, just type them in the \u0026ldquo;message\u0026rdquo; field on the bottom of the screen. You can send them by pressing the enter key on your keyboard, or by clicking on the \u0026ldquo;send\u0026rdquo; button.\nIf you want to add line breaks in your messages, you can use the \u0026ldquo;shift+enter\u0026rdquo; key combination.\nYou can add emojis to your messages. You can for example use the emojis menu, or directly type emojis shortcuts like :smiley:.\nYou can mention other participants. To do so, you can type the first nickname letters, then press the tab key. You can also type @: this will directly open the menu. You can also click on a nickname in the participants list to insert it in the message field.\nParticipants list To see the list of participants, just open the right menu:\nYou can see that some participants have special rights (moderator, owner, \u0026hellip;).\nChat dropdown menu There is a dropdown menu on the top of the chat, with some advanced features. This is especially useful for moderation features. Available features depends on your access level.\nOpening full screen On top of the chat, there is a button to open the chat in fullscreen. This will open a new browser tab with the following content:\nIt can be easier to chat using a full browser tab.\nChanging nickname You can change your nickname by typing /nick your_new_nickname in the message field.\nYou can also change your nickname using the chat menu.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/bot/forbidden_words/","title":"Forbidden words","tags":[],"description":"The bot can automatically moderate messages containing forbidden words.","content":"You can configure some words that will be automatically moderated by the bot (messages containing such words will be instantly deleted). You can also add an optional reason that will be displayed at the place of deleted messages. Several examples are provided on the documentation page. You can fill several \u0026ldquo;Forbidden words or expressions\u0026rdquo; fields. When a user sends a message that match the configured criteria, the message will automatically be deleted.\nForbidden words or expressions In this field, you can set several words, group of words, or \u0026ldquo;regular expressions\u0026rdquo;.\nOne word or expression per line. If you put multiple words on one line, it will only match messages containing the whole sequence. Each time a user sends a message, these words will be tested. If the message containes one of them, the message will be deleted.\nYou can for example fill this field with a swear words list.\nTo get some examples, please check these forbidden words suggestions.\nIf you have some usefull words lists, you are welcome to contribute to this suggestion page. There are in the support/forbidden_words folder of the livechat source code. See the contribution guide for more information.\nThese words are case insensitive.\n This features is still experimental. There might be some issues with non-latin alphabets. You can open an issue to report your problems.\n Consider as regular expressions By checking this option, each line of the \u0026ldquo;Forbidden words or expressions\u0026rdquo; field will be considered as a regular expression.\nAlso moderate messages from moderators By default, moderator messages will not be deleted when containing forbidden words. By checking this option, messages from moderators will also be deleted. Reason Reason to display besides deleted messages Comments You can add here some comments about this rule, to remember how and why you created it. These comments are purely indicative, and have no influence on the bot's behavior. "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/admin/settings/","title":"Settings","tags":[],"description":"Plugin Peertube Livechat settings","content":"This section describes the plugin settings page.\nChannel's chat terms \u0026 conditions You can configure a \"terms \u0026 conditions\" message that will be shown to users joining your chatrooms. For more information on this feature, check the documentation for channel\u0026rsquo;s terms \u0026amp; conditions.\nChanging this setting will restart the chat server, and all users will be disconnected for a short time.\n List existing rooms When pressing the «List rooms» button, all existing chatrooms will be listed. You can then find them and moderated them.\nFederation Following settings concern the federation with other Peertube instances, and other fediverse softwares.\nDon't display remote chats By checking this setting, your instance will never display chats from remote videos. Don't publish chat information By checking this setting, your instance will not publish chat information on the fediverse. Remote Peertube instances will not be aware that they are chat rooms associated to your videos.\nPlease note: if you already had chats in progress, it is possible that the information has already been published. You will have to wait for the next video update before the information is unpublished. Also, if you disable this setting, you'll have to wait for the videos to be updated before the information are published again. This update happens among others when a live event resumes or stops.\nPlease note: this setting only affects the publication of information via the ActivityPub protocol. It will not prevent a remote application from otherwise detecting the presence of chats, and trying to connect to it. Authentication Disable livechat tokens In case you have any trouble with the long term authentication tokens, you can disable the feature here.\nExternal Authentication See the detailed documentation page:\nExternal Authentication\nChannel advanced configuration Following settings concern the advanced channel options: users will be able to add some customization on their channels, activate the moderation bot, \u0026hellip;\nDisable the advanced channel configuration and the chatbot If you encounter any issue with this feature, you can disable it.\nChat behaviour Room type You can choose here to have separate rooms for each video, or to group them by channel. Automatically open the chat When watching a video, the chatbox will automatically open. Show the «open in new window» button There will be a button for opening the web chat in a new window. Show the «share chat link» button This feature enables a «share chat link» modal. With this modal, you can generate URLs to join the chat. The chat can be customized (readonly mode, use the current theme, \u0026hellip;).\nYou can for example generate a readonly URL and use it in OBS to integrate the chat in your live stream!\nThis setting allows you to choose who can access this modal.\nUsers can activate the chat for their lives If checked, all live videos will have a checkbox in their properties for enabling the web chat. The video owner will be able to activate web chats.\nActivate chat for all lives If checked, the chat will be enabled for all lives. Activate chat for all non-lives Activate chat for all non-lives Activate chat for these videos Activate chat for these videos Hide the chat for anonymous users If checked, anonymous Peertube users won't see the chat. This feature is still experimental. If you enabled it, it is highly recommended to also check \"Don't publish chat information\". Otherwise, some third party tools could try to open the chat, and have unpredictable behaviours. Note: for now this feature simply hide the chat. In a future release, the chat will be replaced by a message saying «please log in to [\u0026hellip;]». See v5.7.0 Release Notes for more information.\nBan anonymous user's IP when user is banned from a chatroom By enabling this option, each time an anonymous user is banned from a chatroom, it's IP will also be banned from the chat server. Warning: if your instance is open to registration, any user could create a trapped-room, invite users to join, and automatically ban all anonymous user's IPs. The banned IP list is not stored, it will be cleared on server restart, or when you change some plugin's settings. The banned IP are logged in the Prosody server log files, so server's administrators can eventually use some external tools (like fail2ban) to ban IPs more widely. Important note: If you enable this feature, and are using a custom reverse proxy on front of Peertube, please make sure that your setup is correctly configured to forward real user\u0026rsquo;s IPs to Peertube. Otherwise it could block all anonymous users at once.\nTheming Avatar set You can choose from several different sets the default avatars that will be used for chat users.\nSepia (Peertube mascot): David Revoy\u0026rsquo;s Peertube avatar generator, CC-By license\nCats: David Revoy\u0026rsquo;s cat avatar generator, CC-By license\nBirds: David Revoy\u0026rsquo;s bird avatar generator, CC-By license\nFenecs (Mobilizon mascot): David Revoy\u0026rsquo;s fenec/mobilizon avatar generator, CC-By license\nAbstract: David Revoy\u0026rsquo;s Abstract avatar generator, CC-By license\nLegacy Sepia avatars (those included in previous plugin versions): Based on David Revoy' work, AGPL-v3 license\nIf you can\u0026rsquo;t see the change immediatly, it could be because of your browser cache. Just clear your browser session storage, or restart it.\nConverseJS theme You can choose which theme to use for ConverseJS:\n Peertube theme: this is a special theme, made especially for peertube\u0026rsquo;s integration. Default ConverseJS theme: this is the default ConverseJS theme. ConverseJS concord theme: this is a theme provided by ConverseJS.  Automatic color detection Try to autodetect colors from user's current theme.\nWhen this setting is enabled, the plugin tries to auto-detect colors to apply to the chat theme.\nIf this is not correctly working for some of your Peertube theme, you can disable this option. You can report the bug on the official issue tracker . Don't forget to specify which theme is not working. Webchat iframe style attribute Additional styles to be added on the iframe style attribute. Example: height:400px; Chat server advanced settings Use system Prosody The plugin comes with an AppImage that is used to run the Prosody XMPP server. If this AppImage is not working, you can fallback to the Prosody that is packaged for your server. Just install the prosody package.\nThis setting should only be used if the plugin is broken, and waiting for a patch.\nDisable Websocket With Peertube \u0026gt;= 5.0.0, this plugin try to use Websocket connection for chatting. If the user's browser or connection is incompatible, the browser will automatically fall back on the BOSH protocol. But in rare case, this can fail. For example, if you have a reverse proxy in front of Peertube that does not allow Websocket connection for plugins. In this case, you can check this setting to disable Websocket connections. Prosody port The port that will be used by the Prosody server.\nChange it if this port is already in use on your server.\nYou can close this port on your firewall, it will not be accessed from the outer world.\nNote: this might change in a near future, as it is planned to add a feature to activate external connections. Peertube url for API calls Please let this setting empty if you don't know what you are doing.\nIn some rare cases, Prosody can't call Peertube's API from its public URI. You can use this field to customize Peertube's URI for Prosody modules (for example, with «http://localhost:9000» or «http://127.0.0.1:9000»). If this setting is left empty, and you are using Peertube \u0026gt;= 5.1 or later, the plugin will use values from your Peertube configuration file to guess on which interface and port request have to be done.\nIn last resort, it will use your Peertube public URI. So, any API Call will go throught your Nginx server. This could fail in some case: for example if you are in a Docker container, where the public hostname does not resolve to the correct IP. In such case, try changing the \u0026ldquo;Peertube url for API calls\u0026rdquo; settings, by setting http://127.0.0.1:9000 (assuming 9000 is the port on which Peertube listen, ask your instance administrators if you don\u0026rsquo;t know).\nLog rooms content by default If checked, room contents will be saved by default. Any user who joins a room will see what was written before he joins.\nPlease note that it is always possible to enable/disable the content archiving for a specific room, by editing its properties. Room logs expiration You can choose here how long the chatting room's content is kept by the server. The value can be:  60: the content will be saved for 60 seconds. You can replace 60 by any integer value. 1d: the content will be saved for 1 day. You can replace 1 by any integer value. 1w: the content will be saved for 1 week. You can replace 1 by any integer value. 1m: the content will be saved for 1 month. You can replace 1 by any integer value. 1y: the content will be saved for 1 year. You can replace 1 by any integer value. never: the content will never expire, and will be kept forever.  Enable connection to room using external XMPP accounts By enabling this option, it will be possible to connect to rooms using external XMPP accounts and XMPP clients.\nWarning, enabling this option can request extra server and DNS configuration.  Please refer to the documentation: Enable external XMPP account connections.  Prosody server to server port The port that will be used for XMPP s2s (server to server) connections.\nYou should use the standard 5269 port. Otherwise you should setup a specific DNS record . Server to server network interfaces The network interfaces to listen on for server to server connections.\nList of IP to listen on, coma separated (spaces will be stripped).\nYou can use «*» to listen on all IPv4 interfaces, and «::» for all IPv6.\nExamples:  *, :: * 127.0.0.1, ::1 172.18.0.42  Certificates folder If this field is empty, the plugin will generate and use self-signed certificates.\nIf you want to use other certificates, just specify here the folder where Prosody can find them. Note: the \"peertube\" user must have read access to this folder. Enable client to server connections Enable XMPP clients to connect to the built-in Prosody server.\nThis option alone only allows connections from localhost clients. This setting enable XMPP clients to connect to the built-in Prosody server. For now, this option only allows connections from localhost clients.\nAs example, this option can allow an instance of Matterbridge (once it could use anonymous login) on the same machine to bridge your chat with another services like a Matrix room.\nProsody client to server port The port that will be used by the c2s module of the built-in Prosody server.\nXMPP clients shall use this port to connect.\nChange it if this port is already in use on your server.\nYou can keep this port closed on your firewall for now, it will not be accessed from the outer world.\nNote: this might change in a near future, as it is planned to add a feature to activate external connections. Client to server network interfaces The network interfaces to listen on for client to server connections.\nThis setting is provided for advanced users. Don't change this setting if you don't fully understand what it means.\nList of IP to listen on, coma separated (spaces will be stripped).\nYou can use «*» to listen on all IPv4 interfaces, and «::» for all IPv6.\nExamples:  *, :: * 127.0.0.1, ::1 127.0.0.1, ::1, 172.18.0.42  Enable custom Prosody external components This setting enable XMPP external components to connect to the server. By default, this option only allows connections from localhost components. You have to change the \u0026ldquo;Prosody external components network interfaces\u0026rdquo; value to listen on other network interfaces.\nThis feature could be used to connect bridges or bots.\nMore informations on Prosody external components here.\nEnable custom Prosody external components Enable the use of external XMPP components.\nThis option alone only allows connections from localhost. You have to setup the listening interfaces and open the port on your firewall to make it available from remote servers.\nThis feature can, for example, be used to connect some bots to the chatting rooms. Prosody external components port The port that will be used by XMPP components to connect to the Prosody server.\nChange it if this port is already in use on your server.\nYou can keep this port closed on your firewall if you don't allow access on interfaces other than localhost. Prosody external components network interfaces The network interfaces to listen on for external components connections.\nList of IP to listen on, coma separated (spaces will be stripped).\nYou can use «*» to listen on all IPv4 interfaces, and «::» for all IPv6.\nExamples:  *, :: * 127.0.0.1, ::1 172.18.0.42  External components The external components to declare:  One per line. Use the format «component_name:component_secret» (spaces will be trimmed). You can add comments: everything after the # character will be stripped off, and empty lines ignored. The name can only contain latin alphanumeric characters and dots.  If the name contains only alphanumeric characters, it will be suffixed with the XMPP domain. For example, «bridge» will become «bridge.your_domain.tld». You can also specify a full domain name, but you have to make sure to configure your DNS correctly.  Only use alphanumeric characters in the secret passphrase (use at least 15 characters).  "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/technical/sourcecode/","title":"Source code","tags":[],"description":"Source code organization","content":"This page describes the different source code folders and their content.\nbuild files Files in the root dir that begins with build- are files used to build the plugin. See the package.json file for more information.\nassets assets/images The assets/images folder contains all icons files used by the plugin.\nThere is also the assets/images/avatars folders, which contains avatars used for anonymous chat users. These files are used to generate multiple avatars (see the build-avatars.js script for more information).\n assets/images/avatars/legacy contains legacy avatar set (livechat versions until 8.1.0 included) assets/images/avatars/sepia contains new sepia avatar set, based on the work of David Revoy (see copyright informations) assets/images/avatars/cat contains new cats avatar set, based on the work of David Revoy (see copyright informations) assets/images/avatars/bird contains new birds avatar set, based on the work of David Revoy (see copyright informations) assets/images/avatars/fenec contains new fenecs avatar set, based on the work of David Revoy (see copyright informations) assets/images/avatars/abstract contains new abstract avatar set, based on the work of David Revoy (see copyright informations)  assets/styles The assets/styles folder contains the livechat plugin SCSS source files.\nbuild The build folder is not part of the source code, but is used to put some files during the build process.\nFor example, build-conversejs.js use the folder build/conversejs to build a customized ConverseJS version.\nclient The client folder contains the front-end source code.\nFiles like client/common-client-plugin.ts, admin-plugin-client-plugin.ts, \u0026hellip; are the base files that are loaded by Peertube for different \u0026ldquo;scopes\u0026rdquo; (common, videowatch, \u0026hellip;). Please refer to the Peertube plugin documentation for more information.\nconversejs The conversejs folder contains code relative to the use of ConverseJS.\nconversejs/custom The conversejs/custom folder contains some files that are used to customize ConverseJS. See the build-conversejs.sh script for more information.\ndist The dist folder is where goes all files created during the build process. It is not part of the source code.\ndocumentation The folder documentation is deprecated. We only keep files in this folder to avoid dead links (links to these files were shared on many websites or social media posts).\nThe source code for the new documentation is in support/documentation/content/en, and is used to generate the documentation web site.\nlanguages The folder languages contains the languages files. These files are translated using Weblate).\nprosody-modules The prosody-modules folder contains some modules used by Prosody.\nSome of them are \u0026ldquo;officials\u0026rdquo; plugins, others are specific to this plugin.\nserver The server folder contains the backend source code.\nshared The shared folder contains comme code that will be used both on frontend and backend.\nsupport/documentation The support/documentation contains the documentation source code.\nvendor The vendor folder is not part of the source code. It is used during the build process to download some external source code.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/installation/troubleshooting/","title":"Troubleshooting","tags":[],"description":"Some classic mistakes and workarounds.","content":"I just installed/upgraded the plugin, but nothing happens If you have just installed/upgraded the plugin, but nothing happens (no chat, no settings, buttons in the settings page does not work, \u0026hellip;), just try to reload the page.\nDiagnostic tool If the chat does not work, there is a diagnostic tool in the plugin\u0026rsquo;s settings pages.\nOpen the plugin settings, and click on the \u0026ldquo;launch diagnostic\u0026rdquo; button.\nIf there is any error in the diagnostic page, you can search in this page for a solution, or refer to the Bug tracking documentation page if you can\u0026rsquo;t find any response.\nChat does not load Internal API calls In some case (like for some Docker Peertube installation), the diagnostic tools displays an error for the test called \u0026ldquo;API Prosody -\u0026gt; Peertube is KO\u0026rdquo;.\nIn such case, try changing the \u0026ldquo;Peertube url for API calls\u0026rdquo; settings, by setting http://127.0.0.1:9000 (assuming 9000 is the port on which Peertube listen, ask your instance administrators if you don\u0026rsquo;t know).\nCheck the help for this setting for more information.\nWebsocket If everything is fine in the diagnostic tools, but chat windows remains empty: it can be a Websocket issue. Since Peertube version 5.0.0, there are some additional configuration to do on the server side. Check with the instance administrators that they did not forgot to apply changes listed in the Peertube v5.0.0 release notes.\nYou can confirm that it is a Websocket issue by opening your browser console, and checking for error logs talking about failed Websocket connection.\nIf you can\u0026rsquo;t fix this immediatly, you can disable Websocket by unchecking \u0026ldquo;Disable Websocket\u0026rdquo; in the plugin setting page. In such case, you should also check \u0026ldquo;Don't publish chat information\u0026rdquo;, as chat federation won\u0026rsquo;t work without Websocket.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/","title":"User documentation","tags":[],"description":"Plugin peertube-plugin-livechat user documentation","content":"  For viewers  How to chat for stream viewers\n   OBS  Documentation to stream the chat content using OBS.\n   XMPP Clients  Connect to chat using a XMPP client\n   For streamers  How to setup the chat for your live stream\n  Some basics  Some basics about how to setup and use the chat for your live stream\n   Channel configuration  Peertube channel chatrooms configuration\n   Moderation  Plugin peertube-plugin-livechat advanced moderation features\n   Terms \u0026amp; conditions  Configure channel\u0026#39;s chat terms \u0026amp; conditions\n   Slow mode  Plugin peertube-plugin-livechat slow mode\n   Moderation delay  Plugin peertube-plugin-livechat moderation delay\n   Custom emojis  Plugin peertube-plugin-livechat custom emojis\n   Polls  You can create polls to ask viewers their opinion.\n   Tasks / To-do lists  You can handle tasks and task lists with your moderation team.\n   Chat bot  Chat bot setup\n  Forbidden words  The bot can automatically moderate messages containing forbidden words.\n Timers  The bot can send periodically some messages.\n Commands  The bot can respond to several commands.\n   "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/admin/external_auth/","title":"External Authentication","tags":[],"description":"Plugin Peertube Livechat settings - External Authentication","content":"Users that are not connected to your Peertube instance are joining the chat using \u0026ldquo;anonymous accounts\u0026rdquo; (they can freely choose a nickname, and will be assigned a random avatar).\nYou can enable some external authentication methods to allow user to create chat accounts. In such case their nickname and avatar will be automatically initialized with the remote account information.\nSuch \u0026ldquo;external account users\u0026rdquo; will be easier to moderate than anonymous accounts.\nThis also allows user to join the chat without creating Peertube account (in case your instance has closed registration for example, or without waiting for account approval).\nThis page will describe available authentication methods.\nFor the user documentation, see user documentation\nOpenID Connect This feature is still experimental. This feature is available with the plugin version \u0026gt;= 9.0.0.\n You can configure one external OpenID Connect compatible provider.\nDoing so, you can for example use your website for Single Sign-On.\nPopular CMS softwares (Wordpess, \u0026hellip;) offers plugins implementing OpenID Connect.\nTo enable this feature, first you have to create a client on your provider side (check the related documentation for enabling OpenID Connect). Then go to the plugin settings, and enable \u0026ldquo;Use an OpenID Connect provider\u0026rdquo;.\nNote: if you want to restrict allowed redirection urls on the provider side (best security practice), the plugin will show you the url to allow. Just copy it in your OpenID Connect application configuration.\nYou will now have to fill some settings.\nLabel for the connection button This label will be displayed to users, as the button label to authenticate with this OIDC provider. This is the button label in the following screenshot:\nFor now, it is not possible to localize this label.\nDiscovery URL Your OpenID Connect provider must implement the discovery URL. Just set here the discovery url, that should be something like https://example.com/.well-known/openid-configuration.\nNote: if your provider use the standard /.well-known/openid-configuration path, you can omit it. For example https://accounts.google.com will work.\nClient ID Your application Client ID.\nClient secret You application Client secret.\nGoogle, Facebook, \u0026hellip; In addition to that, you can also configure one or several \u0026ldquo;standard\u0026rdquo; Open ID Connect provider (Google, Facebook, \u0026hellip;).\nFor these providers, discovery url and button label are preset. You just have to create an OAuth2 application on the provider side, and configure Client ID and Client Secret.\nIf you think of a standard provider that is not available, you can ask for implementation by opening a new issue.\nTroubleshooting If the button does not appear for end users, there might be a configuration issue. You can try the diagnostic tool to get more information.\nNote: if you are connected to your Peertube account, the button will never show. So use a private browser window to test.\nIf the button is displayed but is not working, check your Peertube logs. It could be because the remote service does not use standard scopes or attribute names.\nMore to come Other authentication methods will be implemented in the future.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/admin/advanced/","title":"Advanced usage","tags":[],"description":"Some advanced features","content":"  XMPP clients  Allow connections using XMPP clients\n   Using Matterbridge  Using Matterbridge to bridge with other chats\n   "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/installation/","title":"Installation guide","tags":[],"description":"Plugin peertube-plugin-livechat installation guide","content":" Before updating to a major release, please read the release notes and breaking changes list : CHANGELOG.\n To install or update the plugin, just use the Peertube web admin interface.\n Here are some other more specific instructions:\n Troubleshooting  Some classic mistakes and workarounds.\n   Known issues: CPU Compatibility  For now, the plugin only works out of the box for x86_64 and arm64 CPU architecture. Here are some instructions for other CPU architectures.\n   Upgrade from version older than 6.0.0  Important notes when upgrading for an older version.\n   "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/installation/cpu_compatibility/","title":"Known issues: CPU Compatibility","tags":[],"description":"For now, the plugin only works out of the box for x86_64 and arm64 CPU architecture. Here are some instructions for other CPU architectures.","content":"The Prosody AppImage included in the plugin will only work on x86_64 and arm64 CPU. It is not compatible with other CPU architectures.\nTo use the plugin, you will have to manually install Prosody on your server (see below).\nNote: the plugin requires Prosody \u0026gt;= 0.12.0. If you are using an older version, Chat Federation could be broken, and it could have some unexpected behaviour.\nOnce it is done, you have to check Use system Prosody in the plugin settings.\nOn non-docker Peertube installation For standard installation, you just have to install the official prosody package for your linux distribution.\nFor example, on Debian/Ubuntu:\nsudo apt install prosody You can then disable the service that starts automatically when you install Prosody (the plugin will launch a Prosody process, there is no need for the service to run). For example, on Debian/Ubuntu (and other Systemd based linux distributions):\nsudo systemctl disable prosody \u0026amp;\u0026amp; sudo systemctl stop prosody Warning: do not disable Prosody if it is used for another service on your server, like for example Jitsi.\nDocker You will have to generate a Peertube image that includes Prosody in the same container that Peertube. I know this is not the standard way to do this with Docker, but keep in mind it is a temporary workaround.\nTo generate and use such an image, please refer to the Docker documentation. The Docker file to generate the image should be:\nFROMchocobozzz/peertube:production-bullseyeRUN apt -y update \u0026amp;\u0026amp; apt install -y prosody \u0026amp;\u0026amp; apt -y cleanYunohost You have to disable metronome (the XMPP server provided by Yunohost), and install prosody.\nThis is already done by the Yunohost Peertube application, as it was required for the plugin before the v6.0.0.\nBut it may be removed in a near feature (to avoid drawbacks of this method). I have to discuss with Yunohost team, to decide how we can do to minimize drawbacks, and maximize compatibility.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/technical/thirdparty/","title":"Third party","tags":[],"description":"Displaying the livechat with 3rd party software.","content":" This page describes experimental features. These features are available with the plugin version \u0026gt;= 7.2.0.\n Introduction Peertube is part of the Fediverse. So Peertube video can be watched from other Peertube instances, and from various other softwares:\n from a Mastodon (or other fediverse application) instance, from a mobile app (Fedilab, Tusky, \u0026hellip;), from desktop fediverse app, \u0026hellip;  This livechat plugin is using well known standards, so it is possible to join chat rooms even when not viewing the video on Peertube.\nThere are basically 2 ways to join the chat room associated to a video:\n opening a web page (with an url like https://yourinstance.tld/plugins/livechat/router/webchat/room/8df24108-6e70-4fc8-b1cc-f2db7fcdd535), using a XMPP client (and joining a room like xmpp://8df24108-6e70-4fc8-b1cc-f2db7fcdd535@room.yourinstance.tld?join)  Joining the chat using a XMPP client is not always possible. It requires some DNS and server configuration. It will only be possible if instance\u0026rsquo;s admins have correctly setup the external XMPP clients connection feature.\n Don\u0026rsquo;t try to gues these url and connection methods yourself. Please report to next chapters.\n Chat discovery Using ActivityPub The livechat plugin adds some data in Video ActivityPub objects, so that the chat can be discovered.\nThis requires Peertube \u0026gt;= 5.1\n This follows the FEP-1970 recommendations.\nAt the time of the writing, this FEP is in draft status, and the livechat plugin is a Proof-of-concept. Until the FEP is adopted, the specification can change, and the livechat plugin will be adapted accordingly.\n Basically, the chat will be declared as attachments on the Video object, using the discussion relation.\nBy default, here is an example of what you will get:\n{ \u0026#34;@context\u0026#34;: [ \u0026#34;https://www.w3.org/ns/activitystreams\u0026#34;, \u0026#34;https://w3id.org/security/v1\u0026#34;, { \u0026#34;RsaSignature2017\u0026#34;: \u0026#34;https://w3id.org/security#RsaSignature2017\u0026#34; }, { // ...  } ], \u0026#34;to\u0026#34;: [ \u0026#34;https://www.w3.org/ns/activitystreams#Public\u0026#34; ], \u0026#34;cc\u0026#34;: [ \u0026#34;https://yourinstance.tld/accounts/root/followers\u0026#34; ], \u0026#34;type\u0026#34;: \u0026#34;Video\u0026#34;, \u0026#34;id\u0026#34;: \u0026#34;https://yourinstance.tld/videos/watch/8df24108-6e70-4fc8-b1cc-f2db7fcdd535\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;The video title\u0026#34;, // ...  \u0026#34;url\u0026#34;: [ /* ... */ ], \u0026#34;attachment\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;Link\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;Chat for live stream: The video title\u0026#34;, \u0026#34;rel\u0026#34;: \u0026#34;discussion\u0026#34;, \u0026#34;href\u0026#34;: \u0026#34;https://yourinstance.tld/plugins/livechat/router/webchat/room/8df24108-6e70-4fc8-b1cc-f2db7fcdd535\u0026#34; } ] } In case the instance has activated the external XMPP clients connection feature:\n{ \u0026#34;@context\u0026#34;: [ \u0026#34;https://www.w3.org/ns/activitystreams\u0026#34;, \u0026#34;https://w3id.org/security/v1\u0026#34;, { \u0026#34;RsaSignature2017\u0026#34;: \u0026#34;https://w3id.org/security#RsaSignature2017\u0026#34; }, { // ...  } ], \u0026#34;to\u0026#34;: [ \u0026#34;https://www.w3.org/ns/activitystreams#Public\u0026#34; ], \u0026#34;cc\u0026#34;: [ \u0026#34;https://yourinstance.tld/accounts/root/followers\u0026#34; ], \u0026#34;type\u0026#34;: \u0026#34;Video\u0026#34;, \u0026#34;id\u0026#34;: \u0026#34;https://yourinstance.tld/videos/watch/8df24108-6e70-4fc8-b1cc-f2db7fcdd535\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;The video title\u0026#34;, // ...  \u0026#34;url\u0026#34;: [ /* ... */ ], \u0026#34;attachment\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;Link\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;Chat for live stream: The video title\u0026#34;, \u0026#34;rel\u0026#34;: \u0026#34;discussion\u0026#34;, \u0026#34;href\u0026#34;: \u0026#34;https://yourinstance.tld/plugins/livechat/router/webchat/room/8df24108-6e70-4fc8-b1cc-f2db7fcdd535\u0026#34; }, { \u0026#34;type\u0026#34;: \u0026#34;Link\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;Chat for live stream: The video title\u0026#34;, \u0026#34;rel\u0026#34;: \u0026#34;discussion\u0026#34;, \u0026#34;href\u0026#34;: \u0026#34;xmpp://8df24108-6e70-4fc8-b1cc-f2db7fcdd535@room.yourinstance.tld?join\u0026#34; } ] } Algorithm If you want to display the chat in a web page or in an iframe, here is what you should do:\n get the Video ActivityPub object, if there is no attachment key, stop. loop through the attachment values (if attachment is not an array, just iterate on this single value) search for an entry with rel === discussion, and with href using the https scheme (that begins with https://) if found, open this href  If you want to open the chat room using the XMPP protocol:\n get the Video ActivityPub object, if there is no attachment key, stop. loop through the attachment values (if attachment is not an array, just iterate on this single value) search for an entry with rel === discussion, and with href using the xmpp scheme (that begins with xmpp://) if found, open this xmpp uri with your client, or connect to the XMPP room at that address  Additional notes In the ActivityPub object, there is also a peertubeLiveChat entry. Don\u0026rsquo;t use the content of this entry. This is specific to the livechat plugin, and can be changed or removed in a near future. It is currently required for some endpoint discovery.\nUsing Podcast RSS feed The livechat plugin adds some data in Podcast RSS feeds under the \u0026lt;podcast:liveItem\u0026gt;, so that the chat can be discovered for live streams.\nThis requires Peertube \u0026gt;= 5.2\n The \u0026lt;podcast:chat\u0026gt; element is currently only supported for live streams.\n This follows the \u0026lt;podcast:chat\u0026gt; proposal.\nAt the time of the writing, this proposal is in draft status, and the livechat plugin is a Proof-of-concept. Until the proposal is adopted, the specification can change, and the livechat plugin will be adapted accordingly.\n Basically, the chat will be declared as tag under on the \u0026lt;podcast:liveItem\u0026gt; element.\nBy default, here is an example of what you will get:\n\u0026lt;podcast:liveItem status=\u0026#34;live\u0026#34; start=\u0026#34;2023-07-06T18:00:00.000Z\u0026#34;\u0026gt; \u0026lt;title\u0026gt;The video title\u0026lt;/title\u0026gt; \u0026lt;guid isPermaLink=\u0026#34;false\u0026#34;\u0026gt;e32b4890-983b-4ce5-8b46-f2d6bc1d8819_2023-07-06T18:00:00.000Z\u0026lt;/guid\u0026gt; \u0026lt;link\u0026gt;https://yourinstance.tld/videos/watch/8df24108-6e70-4fc8-b1cc-f2db7fcdd535\u0026lt;/link\u0026gt; \u0026lt;podcast:socialInteract uri=\u0026#34;https://yourinstance.tld/videos/watch/8df24108-6e70-4fc8-b1cc-f2db7fcdd535\u0026#34; protocol=\u0026#34;activitypub\u0026#34; accountUrl=\u0026#34;https://yourinstance.tld/a/youraccount\u0026#34; /\u0026gt; \u0026lt;enclosure url=\u0026#34;https://yourinstance.tld/path/to/video/master.m3u8\u0026#34; type=\u0026#34;application/x-mpegURL\u0026#34; /\u0026gt; \u0026lt;podcast:alternateEnclosure type=\u0026#34;application/x-mpegURL\u0026#34; lang=\u0026#34;en\u0026#34; title=\u0026#34;HLS\u0026#34; default=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;podcast:source uri=\u0026#34;https://yourinstance.tld/path/to/video/master.m3u8\u0026#34; /\u0026gt; \u0026lt;/podcast:alternateEnclosure\u0026gt; \u0026lt;itunes:image href=\u0026#34;https://yourinstance.tld/lazy-static/previews/8df24108-6e70-4fc8-b1cc-f2db7fcdd535.jpg\u0026#34; /\u0026gt; \u0026lt;podcast:chat server=\u0026#34;yourinstance.tld\u0026#34; protocol=\u0026#34;xmpp\u0026#34; embedUrl=\u0026#34;https://yourinstance.tld/plugins/livechat/router/webchat/room/8df24108-6e70-4fc8-b1cc-f2db7fcdd535\u0026#34; /\u0026gt; \u0026lt;/podcast:liveItem\u0026gt; In case the instance has activated the external XMPP clients connection feature:\n\u0026lt;podcast:liveItem status=\u0026#34;live\u0026#34; start=\u0026#34;2023-07-06T18:00:00.000Z\u0026#34;\u0026gt; \u0026lt;title\u0026gt;The video title\u0026lt;/title\u0026gt; \u0026lt;guid isPermaLink=\u0026#34;false\u0026#34;\u0026gt;e32b4890-983b-4ce5-8b46-f2d6bc1d8819_2023-07-06T18:00:00.000Z\u0026lt;/guid\u0026gt; \u0026lt;link\u0026gt;https://yourinstance.tld/videos/watch/8df24108-6e70-4fc8-b1cc-f2db7fcdd535\u0026lt;/link\u0026gt; \u0026lt;podcast:socialInteract uri=\u0026#34;https://yourinstance.tld/videos/watch/8df24108-6e70-4fc8-b1cc-f2db7fcdd535\u0026#34; protocol=\u0026#34;activitypub\u0026#34; accountUrl=\u0026#34;https://yourinstance.tld/a/youraccount\u0026#34; /\u0026gt; \u0026lt;enclosure url=\u0026#34;https://yourinstance.tld/path/to/video/master.m3u8\u0026#34; type=\u0026#34;application/x-mpegURL\u0026#34; /\u0026gt; \u0026lt;podcast:alternateEnclosure type=\u0026#34;application/x-mpegURL\u0026#34; lang=\u0026#34;en\u0026#34; title=\u0026#34;HLS\u0026#34; default=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;podcast:source uri=\u0026#34;https://yourinstance.tld/path/to/video/master.m3u8\u0026#34; /\u0026gt; \u0026lt;/podcast:alternateEnclosure\u0026gt; \u0026lt;itunes:image href=\u0026#34;https://yourinstance.tld/lazy-static/previews/8df24108-6e70-4fc8-b1cc-f2db7fcdd535.jpg\u0026#34; /\u0026gt; \u0026lt;podcast:chat server=\u0026#34;yourinstance.tld\u0026#34; protocol=\u0026#34;xmpp\u0026#34; space=\u0026#34;8df24108-6e70-4fc8-b1cc-f2db7fcdd535@room.yourinstance.tld\u0026#34; embedUrl=\u0026#34;https://yourinstance.tld/plugins/livechat/router/webchat/room/8df24108-6e70-4fc8-b1cc-f2db7fcdd535\u0026#34; /\u0026gt; \u0026lt;/podcast:liveItem\u0026gt; Algorithm If you want to display the chat in a web page or in an iframe, here is what you should do:\n get the Podcast RSS feed for the channel, if there is no \u0026lt;podcast:liveItem\u0026gt; element under the \u0026lt;channel\u0026gt;, stop. find the \u0026lt;podcast:liveItem\u0026gt; you are looking for  \u0026lt;podcast:socialInteract\u0026gt; can be used to cross-reference the items with ActivityPub   if there is no \u0026lt;podcast:chat\u0026gt; element under the \u0026lt;podcast:liveItem\u0026gt;, stop. loop through the \u0026lt;podcast:chat\u0026gt; values (if \u0026lt;podcast:chat\u0026gt; is not an array, just iterate on this single value)  there should only be one, but you should expect to handle several just in case   search for the first entry protocol === xmpp and an embedUrl attribute if found, open this embedUrl  If you want to open the chat room using the XMPP protocol:\n get the Podcast RSS feed for the channel, if there is no \u0026lt;podcast:liveItem\u0026gt; element under the \u0026lt;channel\u0026gt;, stop. find the \u0026lt;podcast:liveItem\u0026gt; you are looking for  \u0026lt;podcast:socialInteract\u0026gt; can be used to cross-reference the items with ActivityPub   loop through the \u0026lt;podcast:chat\u0026gt; values (if \u0026lt;podcast:chat\u0026gt; is not an array, just iterate on this single value)  there should only be one, but you should expect to handle several just in case   search for the first entry protocol === xmpp and a space attribute  space should be an XMPP JID for a MUC   if found, open this XMPP JID with your client after converting it to a join URI, or connect to the XMPP room at that address  "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/bot/quotes/","title":"Timers","tags":[],"description":"The bot can send periodically some messages.","content":"You can configure several timers that will send messages at regular interval. These messages will be sent by the bot every X minutes. You can for example make the bot sent some sponsoring information every 5 minutes. If there is no user in the chatroom, the bot won\u0026rsquo;t send any message.\n Timer You can configure several timers that will send messages at regular interval. These messages will be sent by the bot every X minutes. You can for example make the bot sent some sponsoring information every 5 minutes. One message per line. If multiple messages, it will pick one randomly every X minutes. Send every X minutes The bot will post the message every X minutes. "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/contributing/translate/","title":"Translate","tags":[],"description":"Translate the plugin","content":"You can contribute to this plugin translation. Translations are handled using the Weblate software, using Framasoft Weblate instance.\nNever modify directly files in the languages folder, this could lead to conflicts.\n How to  Create an account: https://weblate.framasoft.org/accounts/register/ Validate your email and follow the link sent Create your password and setup your account Go to the plugin project page: https://weblate.framasoft.org/projects/peertube-livechat/peertube-plugin-livechat/ Choose the locale you want to translate Just translate missing sentences, or correct the ones that seems incorrect to you.  There might be some «very technical» strings. If you are not 100% sure of the meaning, or of your translation, you better not translate it, so it will display in english.\n ConverseJS translations This plugin relies on ConverseJS for the chat front-end. ConverseJS has its own translations, on its own weblate instance. You can also translate directly in the code repository. For more information, check ConverseJS translations documentation.\nAdding a new locale If you think there is a missing locale, please check first if it is handled in Peertube. If so, you can open an issue to ask for it.\nAdding new strings / use translations in the code If you are working on new features, and need new strings, you can create them directly in Weblate. The english version is mandatory. Start with it.\nEach string is linked to a key (for example use_chat). Choose an explicit key in english, lower case.\nIf you have to test new strings without waiting for a Weblate merge, you can modify languages/*.yml files, but avoid to commit these changes (to minimize conflict risks).\nUse translations in front-end code Before using a string in front-end, you need to declare a new constant in client/@types/global.d.ts. The constant name must:\n start with the prefix \u0026ldquo;LOC_\u0026rdquo; use the string key, upper cased you just have to declare its type, not its value  For example, to use \u0026ldquo;use_chat\u0026rdquo;, you have to declare:\ndeclare const LOC_USE_CHAT: string The build-client.js script will read the client/@types/global.d.ts, search for such constants, and load their values from the languages files.\nNow, you can simply call peertubeHelpers.translate(LOC_USE_CHAT) in your code.\nUse translations in back-end code In theory, the only parts of the backend code where you need localization is the settings declaration and standardized data (ActivityPub, RSS, \u0026hellip;). Here we need to get english strings from the translation key.\nNote: you should never need another language translation from backend code. Localization must be done on front-end.\nThere is a lib/loc.ts module providing a loc() function. Just pass it the key to have the english string: loc('diagnostic')'.\nDocumentation translation The documentation translation is done using the corresponding Weblate component.\nThere is a specific \u0026ldquo;Hugo shortcodes\u0026rdquo; you can use to display an application string. Saying you want to display the name of the button \u0026ldquo;open_chat_new_window\u0026rdquo;, you can use this in the documentation markdown file:\n{{% livechat_label open_chat_new_window %}} You can also prevent a whole page from being translating by adding livechatnotranslation: true in the Yaml Font Matter section:\n--- title: \u0026#34;Third party\u0026#34; description: \u0026#34;Displaying the livechat with 3rd party software.\u0026#34; weight: 20 chapter: false livechatnotranslation: true --- Never translate a string in the livechat.en.pot file, it would be ignored. Instead, edit directly the markdown files.\nIf a string contains a link, you can change it for the correct link in the translated language. For example, for a link to this documentation, you can add the language code in the url.\nSome strings are block of code. Don\u0026rsquo;t translate code. But you can translate comments, or parameters if relevant.\nIf you are not sure, just don\u0026rsquo;t translate, and ask what to do.\nThe tool I use to handle translations for the documentation can have strange behaviours. When I add sentences that looks like other existing sentences, it sometimes copies existing translations. So, when you have translations marked as \u0026ldquo;to check\u0026rdquo;, please make sure it doesn\u0026rsquo;t copy a string that has nothing to do with the english one before validating.\nIf you are now sure about the context of a string, you can check the string location in the weblate\u0026rsquo;s right pane, and open the corresponding documentation page. For example, for a string located in the file support/documentation/content/en/documentation/user/streamers.md, the corresponding url is https://livingston.frama.io/peertube-plugin-livechat/documentation/user/streamers/.\nGeneric recommandations Please be inclusive in your wordings, and please respect the code of coduct.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/admin/","title":"Admin documentation","tags":[],"description":"Plugin Peertube Livechat administration","content":"  Settings  Plugin Peertube Livechat settings\n   External Authentication  Plugin Peertube Livechat settings - External Authentication\n   Advanced usage  Some advanced features\n  XMPP clients  Allow connections using XMPP clients\n   Using Matterbridge  Using Matterbridge to bridge with other chats\n    "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/contributing/feedback/","title":"Give your feedback","tags":[],"description":"Give your feedback","content":"You don\u0026rsquo;t need to know how to code to start contributing to this plugin! Other contributions are very valuable too, among which: you can test the software and report bugs, you can give feedback, features that you are interested in, user interface, design, \u0026hellip;\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/admin/advanced/xmpp_clients/","title":"XMPP clients","tags":[],"description":"Allow connections using XMPP clients","content":"This chat module is based on the XMPP protocol, also known as Jabber. It is therefore possible to connect to the chats using XMPP client software. This can for example be useful to facilitate moderation operations.\nFor the user documentation associated with these features, please refer to the user documentation page.\nEnabling these features requires configuration changes on the server, and on the DNS records. It is not possible to configure this only from the Peertube interface, and it requires some basic system some basic system admin skills.\n Login to your Peertube account This feature is not yet available, and will come in a future version of the plugin.\n Connection using an external XMPP account To enable this feature, you will need to set up your server and DNS records, so that XMPP clients can find and access the Prosody server that this plugin uses internally.\nPlugin settings Start by going to the livechat plugin settings of your instance, then enable the setting \u0026ldquo;Enable connection to room using external XMPP accounts\u0026rdquo;. By checking this setting, new settings appear below.\nFirst of all, the \u0026ldquo;Prosody server to server port\u0026rdquo; field. This one defaults to 5269, which is the standard port for this service. You can however change to another port, if this is already in use on your server.\nNext, the field \u0026ldquo;Server to server network interfaces\u0026rdquo; field allows you to specify which network interfaces the server should listen on. The default value \u0026ldquo;*, ::\u0026rdquo; indicates to listen on all IP addresses. You can change these values, if you wish to listen on only certain IP addresses. The syntax is explained next to the setting.\nFor the \u0026ldquo;Certificate folder\u0026rdquo; setting, you can leave it empty. In this case, the plugin will automatically generate self-signed certificates. Some XMPP servers may refuse to connect, depending on their configuration. In this case, you can indicate here a path on the server, in which you must place certificates to be used by the module. It is up to you to generate and renew them. See bellow for more information.\nFirewall You must open the configured port (5269 by default) on your firewall.\nIf you are using Docker for your Peertube, you need to modify the docker-compose.yml file to open port 5269 of the peertube container, so that the outer world can connect to it.\nDNS You need to add DNS records allowing remote servers to find \u0026ldquo;room.your_instance.tld\u0026rdquo; and \u0026ldquo;external.your_instance.tld\u0026rdquo; components.\nThe easiest way to do this is to add SRV records for the \u0026ldquo;room\u0026rdquo; and \u0026ldquo;external\u0026rdquo; subdomain:\n  record name: _xmpp-server._tcp.room.your_instance.tld. (replace «your_instance.tld» by your instance uri)\n  TTL: 3600\n  class: IN\n  SRV: 0\n  priority: 0\n  weight: 5\n  port: 5269 (adapt if your changed the default port)\n  target: your_instance.tld. (replace by your instance uri)\n  record name: _xmpp-server._tcp.external.your_instance.tld. (replace «your_instance.tld» by your instance uri)\n  TTL: 3600\n  class: IN\n  SRV: 0\n  priority: 0\n  weight: 5\n  port: 5269 (adapt if your changed the default port)\n  target: your_instance.tld. (replace by your instance uri)\n  Be careful to keep the dot after \u0026ldquo;your_instance.tld\u0026rdquo;.\nUsing the dig command to check your records, you should get a result similar to this:\n$ dig +short _xmpp-server._tcp.room.videos.john-livingston.fr. SRV 0 5 5269 videos.john-livingston.fr. $ dig +short _xmpp-server._tcp.external.videos.john-livingston.fr. SRV 0 5 5269 videos.john-livingston.fr. If you are not using the standard 5269 port, you must also add a SRV record for _xmpp-server._tcp.your_instance.tld. (same as above, just without the room. prefix). Of course, you can also add this record if you use the standard port. It will also work.\nUsing trusted certificates The self-signed certificates that this plugin uses by default can be rejected by some XMPP servers, for security reasons.\nIt is possible to use certificates validated by a certification authority. However, this requires advanced system administration knowledge. Indeed, due to the multitude of possible use cases, it is impossible to document all situations here. This documentation will therefore only explain the goal to be reached, and give an example which will only be suitable for a \u0026ldquo;basic\u0026rdquo; situation (manual installation of Peertube, using letsencrypt). If you are in another situation (Docker installation, certificates signed by another authority, etc\u0026hellip;), you will have to adapt this approach by yourself.\nBasic principle It is up to you to generate valid certificates for domains your_instance.tld and room.your_instance.tld. You can use any method supported by Prosody.\nYou must then place these certificates in a folder that will be accessible to the peertube user, and specify this folder in the plugin setting \u0026ldquo;Certificate folder\u0026rdquo;.\nIf you want to use the ProsodyCtl utility to import certificates, this utility is available (once Peertube is started) using the following command (adapting the path to your Peertube data folder, and replacing \u0026ldquo;xxx\u0026rdquo; with the arguments you wish to pass to prosodyctl): sudo -u peertube /var/www/peertube/storage/plugins/data/peertube-plugin-livechat/prosodyAppImage/squashfs-root/AppRun prosodyctl xxx\n The plugin will check once a day to see if any files have been modified in this folder, and reload Prosody if necessary.\nMethod for the simple case We assume here that your Peertube installation is \u0026ldquo;classic\u0026rdquo; (no use of Docker), and that the certificates are generated by letsencrypt, using the certbot tool.\nFirst of all, we\u0026rsquo;ll have to create a certificate for the subdomain room.your_instance.tld : this is the uri of the MUC (XMPP chat rooms) component. Even if the connections are made on your_instance.tld, we will need a valid certificate for this subdomain.\nSo start by setting up a DNS entry for room.your_instance.tld, which points to your server. You can use a CNAME entry (or an A entry and a AAAA entry).\nNext, we\u0026rsquo;ll use nginx (already installed for your Peertube) to generate the certbot certificate. We will create a new site. In the file /etc/nginx/site-available/room.peertube, add:\nserver { listen 80; listen [::]:80; server_name room.your_instance.tld; location /.well-known/acme-challenge/ { default_type \u0026#34;text/plain\u0026#34;; root /var/www/certbot; } location / { return 301 https://your_instance.tld; } } Then enable the site:\nln -s /etc/nginx/sites-available/room.peertube /etc/nginx/sites-enabled/ systemc reload nginx Then we prepare the folder in which we will later import the certificates. We assume here that you already have the plugin active. We will create the following folder (if it doesn\u0026rsquo;t already exist), with the user peertube to make sure there are no permissions issues:\nsudo -u peertube mkdir /var/www/peertube/storage/plugins/data/peertube-plugin-livechat/prosody/certs Now you have to configure this folder in the plugin settings, for the parameter \u0026ldquo;Certificate folders\u0026rdquo;. It\u0026rsquo;s important to do this now, otherwise the certificate import script will put the certificates in the wrong folder.\nWe will configure certbot to import the generated certificates into the Prosody folder. We can use the ProsodyCtl utility packaged in the plugin.\nNote: for it to be available, the plugin must have been started at least once.\nWe will create a file /etc/letsencrypt/renewal-hooks/deploy/prosody.sh containing:\n#!/bin/sh /var/www/peertube/storage/plugins/data/peertube-plugin-livechat/prosodyAppImage/squashfs-root/AppRun prosodyctl \\  --root \\  --config /var/www/peertube/storage/plugins/data/peertube-plugin-livechat/prosody/prosody.cfg.lua \\  cert import \\  room.your_instance.tld your_instance.tld /etc/letsencrypt/live Then we ask to generate the certificate:\ncertbot -d room.videos.john-livingston.fr If certbot offers you several methods to generate the certificate, choose \u0026ldquo;nginx\u0026rdquo;.\nNormally you should now find the certificates in the configured folder.\nNote: the first time you do this, you will have to reload Prosody. The easiest way to do this is to restart Peertube.\nMethod for the Docker case This method works with the officially supported Docker guide from PeerTube.\nFirst, ensure you create a DNS entry for room.your_instance.tld, which points to your server. You can use a CNAME entry (or an A entry and a AAAA entry). This is necessary for Let\u0026rsquo;s Encrypt to validate the domain for certificate generation.\nEnter the directory where your docker-compose.yml file exists.\nOpen a shell in the certbot container:\ndocker exec -it certbot /bin/sh Run certbot:\ncertbot You will be presented with a series of prompts. Enter 2 for the authentication type:\nHow would you like to authenticate with the ACME CA? Select the appropriate number [1-2] then [enter] (press \u0026#39;c\u0026#39; to cancel): 2 Enter the domain name room.your_instance.tld:\nPlease enter the domain name(s) you would like on your certificate (comma and/or space separated) (Enter \u0026#39;c\u0026#39; to cancel): room.your_instance.tld Enter the directory where the PeerTube webserver serves requests for Let\u0026rsquo;s Encrypt, /var/www/certbot:\nInput the webroot for \u0026lt;room.your_instance.tld\u0026gt;: (Enter \u0026#39;c\u0026#39; to cancel): /var/www/certbot You should see output like the following:\nSuccessfully received certificate. Certificate is saved at: /etc/letsencrypt/live/room.your_instance.tld/fullchain.pem Key is saved at: /etc/letsencrypt/live/room.your_instance.tld/privkey.pem Run the below command inside the certbot container to give read access to the new certs and private keys to the peertube group. Note: This will also make the files readable to the group with id 999 on the host system. Check the groups on your system to assess this as a risk before running this command.\nchown -R root:999 /etc/letsencrypt/live; \\ chmod 750 /etc/letsencrypt/live; \\ chown -R root:999 /etc/letsencrypt/archive; \\ chmod 750 /etc/letsencrypt/archive; \\ find /etc/letsencrypt/ -name \u0026#39;privkey*\u0026#39; -exec chmod 0640 {} \\; Exit the certbot container:\nexit Modify your docker-compose.yml file, changing the entrypoint line under the certbot service to the following. This is the same as the above, but to be automatically executed after every certificate renewal.\nentrypoint: /bin/sh -c \u0026#34;trap exit TERM; while :; do certbot renew --webroot -w /var/www/certbot; chown -R root:999 /etc/letsencrypt/live; chmod 750 /etc/letsencrypt/live; chown -R root:999 /etc/letsencrypt/archive; chmod 750 /etc/letsencrypt/archive; find /etc/letsencrypt/ -name \u0026#39;privkey*\u0026#39; -exec chmod 0640 {} +; sleep 12h \u0026amp; wait $${!}; done;\u0026#34; Continuing to modify docker-compose.yml, add the certbot certificate volume into the peertube container. It should look something like this:\nvolumes: - ./docker-volume/certbot/conf:/etc/letsencrypt Restart your services:\ndocker-compose down; docker-comopse up -d In the livechat plugin settings from your PeerTube administration settings, set the certificate directory to the following:\n/etc/letsencrypt/live Save the plugin settings and verify Prosody can see the certificates:\ndocker-compose exec -u peertube \\  peertube \\  /data/plugins/data/peertube-plugin-livechat/prosodyAppImage/squashfs-root/AppRun \\  prosodyctl \\  --config /data/plugins/data/peertube-plugin-livechat/prosody/prosody.cfg.lua \\  check certs Troubleshooting If you can\u0026rsquo;t make it work, you can use the diagnostic tool (there is a button on top of the plugin settings page), and take a close look on the «Prosody check» section.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/bot/commands/","title":"Commands","tags":[],"description":"The bot can respond to several commands.","content":"You can configure the bot to respond to commands. A command is a message starting with a \"!\", like for example \"!help\" that calls the \"help\" command. You can setup several commands.\nCommand The command, without the starting \"!\". For example \"help\", \"sponsor\", ... Send every X minutes The bot will post the message every X minutes. "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/contributing/develop/","title":"Develop","tags":[],"description":"Develop","content":"Always talk about features you want to develop by creating/finding and commenting the issue tackling your problem before you start working on it, and inform the community that you begin coding by claiming the issue.\nPull Request must be done on the main branch.\nUntil march 2023, contribution were made on the develop branch. This procedure is now deprecated.\n Prerequisite for building this plugin It is highly recommended to be familiar with following concepts:\n Git NodeJS NPM Typescript  To build the plugin, you must have following packages:\n git npm (\u0026gt;=8.x) nodejs (\u0026gt;=14.x) build-essential coreutils wget reuse  Please note that this plugin needs an AppImage for the Prosody XMPP server. This AppImage is provided by the Prosody AppImage sideproject. The build-prosody.sh script download binaries attached to this remote repository, and checks that their sha256 hashsum are correct.\nDevelop Clone the repository, buid the plugin, and create your feature branch:\n# Clone the repository. Dont forget the --recursive to clone submodules. git clone https://github.com/JohnXLivingston/peertube-plugin-livechat.git --recursive cd peertube-plugin-livechat # Install NPM dependencies and build the module for the first time: npm install # Build the plugin after a modification: npm run build # If you have a fork from the repository, add it as remote (example): git remote add me git@github.com:MY_GITHUB_ACCOUNT/peertube-plugin-livechat.git # Create a local branch for you developments, and checkout it (example): git checkout my_development # Note: if an issue is associated, use fix_1234 as your branch name (where 1234 is the issue\u0026#39;s number) # To propose your modifications, push your branch to your repository (example): git push --set-upstream me my_development # Then go to your github repository with your web browser to propose the Pull Request (see additional instructions below) Once you are ready to show your code to ask for feedback, submit a draft Pull Request. Once you are ready for a code review before merge, submit a Pull Request. In any case, please link your PR to the issues it solves by using the GitHub syntax: \u0026ldquo;fixes #issue_number\u0026rdquo;.\nThe front-end code is in the client folder, the back-end code in server. There are some shared code in shared folder.\nFor general instructions (developping plugins, building, installation, \u0026hellip;), please refer to the Peertube documentation.\nYou can build the plugin with extra debug features simply by using:\nNODE_ENV=dev npm run build This plugin is REUSE compliant: it uses SPDX headers to identify licensing information of its source code. More information on the REUSE website. You can use the reuse command line tool to help you update headers. The npm run lint command will use the reuse command to check compliance. Don\u0026rsquo;t forget to add your copyright information in SPDX headers when you modify some code.\nESBuild vs Typescript This plugin uses ESBuild for frontend code generation, as the official peertube-plugin-quickstart plugin. ESBuild can handle Typescript, but does not check types (see ESBuild documentation). That\u0026rsquo;s why we first compile Typescript with the -noEmit option, just to check types (check:client:ts in package.json file). Then, if everything is okay, we run ESBuild to generate the compiled javascript.\nDebug Mode There is a debug mode for this plugin, that shorten some delay. For example, some log files will rotate every two minutes, instead of once per day. This permit to test more easily certain actions, for which it could normally take hours or days to wait.\nTo enable this mode, you juste have to create the /var/www/peertube/storage/plugins/data/peertube-plugin-livechat/debug_mode file (replacing /var/www/peertube/storage/ by the correct path on your installation).\nThe simple existence of this file is sufficient to trigger the debug mode. To make sure it\u0026rsquo;s taken into account, you can restart your Peertube instance.\nThis file can contain some JSON to enable more advanced options. To have a list of existing parameters, check server/lib/debug.ts. Restart Peertube after each content modification.\nDon\u0026rsquo;t enable this mode on a production server, neither on a public server. This could cause security issues.\n Restart Prosody When debug mode is enabled, you can restart Prosody using this API call: http://your_instance.tld/plugins/livechat/router/api/restart_prosody. This call don\u0026rsquo;t need any authentificaiton. It can be done from a command line, for example using curl http://your_instance.tld/plugins/livechat/router/api/restart_prosody.\nProsody debugger It is possible to connect the Prosody AppImage to a remote debugger using MobDebug.\nTo do so, you have to setup MobDebug in a folder that can be accessed by the peertube user. Then, add this in the debub_mode file:\n{ \u0026#34;debug_prosody\u0026#34;: { \u0026#34;debugger_path\u0026#34;: \u0026#34;/the_path_to_mobdebug/src\u0026#34;, \u0026#34;host\u0026#34;: \u0026#34;localhost\u0026#34;, \u0026#34;port\u0026#34;: \u0026#34;8172\u0026#34; } } host and port are optional. debugger_path must point to the folder where the MobDebug .lua file is.\nRestart Peertube.\nStart your debugger server.\nFor Prosody to connect to the debugger, call the API http://your_instance.tld/plugins/livechat/router/api/restart_prosody?debugger=true. This call does not need any authentication. It can be done from a command line, for example with curl http://your_instance.tld/plugins/livechat/router/api/restart_prosody?debugger=true. You can even configure your debug server to launch this request automatically.\nProsody will then restart, connecting to the debugger.\nQuick dev environment using Docker There is a tutorial, in french, on the Peertube forum that explains how to quickly build a dev env using Docker.\nA repo was made out of it, check out pt-plugin-dev.\nNote: for an unknown reason, Prosody can\u0026rsquo;t resolve containers DNS address when using the lua-unbound library. There is a dirty hack in the plugin: just create a /data/plugins/data/peertube-plugin-livechat/no_lua_unbound file in your docker-volumes, then restart containers.\nQuickly rebuild and install the plugin When you do modification, you don\u0026rsquo;t have to always rebuild the full project, and reinstall the plugin on your dev environment. You can build only the modified part (for example, if you only modified client files: npm run build:client). Check the package.json files for available build scripts.\nWhen the plugin is already installed on your dev instance, and you haven\u0026rsquo;t changed any dependency, you can quickly install your work by following these steps:\n re-build necessary parts of the plugin (client, styles, \u0026hellip;), overwrite the data/plugins/node_modules/peertube-plugin-livechat/dist/ content of your dev instance by the content of the plugin\u0026rsquo;s dist folder, change recursively plugins/node_modules/peertube-plugin-livechat/dist/ files owner to your peertube user, restart your instance.  Performance tests The livechat-perf-test repository contains some tools to make performance tests. It can be used to evaluate code improvements, or find bottlenecks.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/obs/","title":"OBS","tags":[],"description":"Documentation to stream the chat content using OBS.","content":"OBS is a popular Free And Open Source streaming software, with advanced capacities for your live streams. In the current page, you will find some advices to handle your live chats using OBS.\nOBS Overlay You can easily include the chat in your video stream.\nYou can use the \u0026ldquo;Share chat link\u0026rdquo; feature to generate an URL to your chat. This button should be near the chat if you are the video owner (unless it was desactivated by your server admins).\nCheck the \u0026ldquo;Read-only\u0026rdquo; checkbox in the modal.\nThen use this link as a \u0026ldquo;web browser source\u0026rdquo; in OBS.\nYou can use the \u0026ldquo;Transparent background (for stream integration, with OBS for example)\u0026rdquo; option to have a transparent background in OBS. If you want to customize the background transparency, you can add this CSS in your OBS browser source\u0026rsquo;s settings:\n:root { --livechat-transparent: rgba(255 255 255 / 90%) !important; } In the previous CSS snippet, you can of course change the color or the transparency, by adapting the color values.\nNote: you can entirely customize chat colors. This is undocumented yet, but you can try this: in the modal, check «use curent theme colors», then you can try to manually change color values in the URL. You must use valid CSS color values, and they must be properly URL encoded.\nOBS Dock This feature comes with the livechat plugin version 10.1.0.\n This feature can be disabled by the instance\u0026rsquo;s adminitrators.\n You can use OBS \u0026ldquo;Custom browser docks\u0026rdquo; to integrate the chat in your OBS while you are streaming. The livechat plugin offers a way to create long term token that can identify you automatically to join the chat, so you don\u0026rsquo;t have to enter your password in OBS.\nTo do so, just use the \u0026ldquo;Share chat link\u0026rdquo; feature, and open the \u0026ldquo;Dock\u0026rdquo; tab. From there, you can create a new token using the \u0026ldquo;+\u0026rdquo; button.\nThen, copy the url, and use the \u0026ldquo;Docks / Custom browser docks\u0026rdquo; menu from your OBS to add a dock with this URL.\nOnce you have done, you will have a new dock connected to the chat with your account.\nTokens are valid to join any chat room. You don\u0026rsquo;t have to generate separate tokens for each of your rooms. You can also customize the nickame that will be used by changing the n parameter in the url.\n Don\u0026rsquo;t share these links to anyone, as it would allow them to connect as yourself.\nIf a token is compromised, or no more needed, you can revoke them.\nThese tokens can be used for other purposes, as connecting to your account with XMPP bots or clients. This feature is not documented yet, and not officially supported. So use with care.\n Mixing multiple chats in your live stream You can use the social_stream browser extension to mix multiple chat source (from Peertube, Twitch, Youtube, Facebook, \u0026hellip;) and include their contents in your live stream. The compatibility with this plugin was added in recent versions.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/contributing/document/","title":"Documentation","tags":[],"description":"Document the plugin, or translate the documentation.","content":"General information Always inform the community before working (by creating a new issue, or commenting an existing one). This is to avoid that two persons are working on the same thing, and prevent conflicts.\nDocumentation work has to be merged in the main branch.\nThe documentation source code is in the support/documentation/content folder.\nThe documentation is generated using Hugo. You have to install it on your computer if you want to preview your work.\nThe used theme is hugo-theme-learn. You should read its documentation before starting editing the documentation.\nWhen a new plugin version is released, or when documentation is updated, plugin maintainers will merge the main branch to the documentation branch. This will trigger github and gitlab pipelines, and update published documentation.\nTranslations The principal language is english (en code).\nThe support/documentation/content/en folder contains only english documentation files.\nDocumentation is translated using Weblate (see the translation documentation). To do so, we use the po4a tool, as we will se later in this page.\nAdd a new language In the support/documentation/config.toml file, please copy and modify the [Languages.fr] section.\nIf the translations are not complete, it does not matter, english will be used for missing strings.\nPreview To preview your modifications, just run:\nhugo serve -s support/documentation/ Then open your browser on the address http://localhost:1313/peertube-plugin-livechat/. This page will automatically refresh on each modification.\nUpdate localization files and generate documentation translations For now, you only have the english version. To update documentation strings, and generate translations, you have to run the doc-translate.sh script.\nTo do so, make sure you have po4a (version \u0026gt;= 0.69) installed on your computer.\nSome linux distro (like Debian Bullseye for example) have too old version of po4a. Please make sure to install a compatible version. If you are using Debian Bullseye for example, you can download the Bookworm po4a.deb file from https://packages.debian.org, and install it manually.\n To handle translations, just do:\nnpm run doc:translate You can then preview the result using hugo serve -s support/documentation/, and using the language selector.\nWrite documentation Just edit the english files in support/documentation/content/en.\nThen, before commiting, always run npm run doc:translate, so that changes in english files can be propagated to the support/documentation/po/livechat.en.pot file.\nYou can use the livechat_label short code to use application strings. See here: Documentation translation.\nIt is possible to prevent a file from beeing translating, using livechatnotranslation: true in the Yaml Font Matter section. See here: Documentation translation.\nPlease use the livechatnotranslation option for technical documentation. We don\u0026rsquo;t want technical documentation to be translated, to avoid issues because of a wrong translation.\nTo facilitate translators work, avoid making too long paragraphs.\nFor now, it is not possible to use Markdown tables: the translation tools will break them.\nThere may be links to documentation elsewhere on the web. Try not to change the urls of the documentation pages. Or at the very least, put links to the new location on the previous url.\n What if I can\u0026rsquo;t use hugo and/or po4a? Just edit english markdown files, and specify that you can\u0026rsquo;t build translations when you make your Pull Request.\nPublication Publishing the documentation is automatic, as soon as the changes are merged into the documentation branch.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/technical/data/","title":"Plugin storage","tags":[],"description":"Data files and folders used on the server","content":"The livechat plugin stores some data on the server, in the /var/www/peertube/storage/plugins/data/peertube-plugin-livechat/ folder. This page describes these data.\nprosody The prosody folder is used by the Prosody XMPP server to store its data and logs.\nprosodyAppImage This plugin uses the Prosoxy XMPP server in background. This server code is embedded as an AppImage.\nWhen the plugin starts, it deflate this AppImage in the prosodyAppImage folder.\nserverInfos To handle federation between Peertube instances, the plugin needs to store some information concerning remote instances (available protocols, \u0026hellip;).\nThe plugin stores these data in the serverInfos/instance_uri folder (where instance_uri is replaced by the instance uri).\nIn each instance\u0026rsquo;s folder, there can be these files:\n last-update: json file containing the timestamp of the last information update. So we can avoid refreshing too often. ws-s2s: if the server allows XMPP S2S Websocket connections, here are the endpoint information s2s: if the server allows direct XMPP S2S connections, here are the port and url information  videoInfos To handle federation the plugin needs to store some information about remote videos.\nSo, each time we open a new remote chat, a file videoInfos/remote/instance_uri/video_uuid.json is created (where instance_uri is the origin instance uri, and video_uuid is the video uuid).\nThis JSON files contain some data about the remote chat (is it enabled, are anonymous users authorized, which protocol can we use, \u0026hellip;). These data can then be read by the Prosody server to connect to the remote chat.\nMoreover, when the current instance builds such data for local videos, it stores it in videoInfos/local/video_uuid.json (where video_uuid is the video uuid).\nchannelConfigurationOptions The channelConfigurationOptions folder contains JSON files describing channels advanced configuration. Filenames are like 1.json where 1 is the channel id. The content of the files are similar to the content sent by the front-end when saving these configuration.\nroom-channel/muc_domain.json Some parts of the plugin need a quick way to get the channel id from the room Jabber ID, or the all room Jabber ID from a channel id. We won\u0026rsquo;t use SQL queries, because we only want such information for video that have a chatroom.\nSo we will store in the room-channel/muc_domain.json file (where muc_domain is the current MUC domain, something like room.instance.tld) a JSON object representing these relations).\nIn the JSON object, keys are the channel ID (as string), values are arrays of strings representing the rooms JIDs local part (without the MUC domain).\nWhen a chatroom is created, the corresponding entry will be added.\nHere is a sample file:\n{ \u0026#34;1\u0026#34;: [ \u0026#34;8df24108-6e70-4fc8-b1cc-f2db7fcdd535\u0026#34; ] } This file is loaded at the plugin startup into an object that can manipulate these data.\nSo we can easily list all rooms for a given channel id or get the channel id for a room JID (Jabber ID).\nNote: we include the MUC domain (room.instance.tld) in the filename in case the instance domain changes. In such case, existing rooms could get lost, and we want a way to ignore them to avoid gettings errors.\nNote: there could be some inconsistencies, when video or rooms are deleted. The code must take this into account, and always double check room or channel existence. There will be some cleaning batch, to delete deprecated files.\nbot/muc_domain The bot/muc_domain (where muc_domain is the current MUC domain) folder contains configuration files that are read by the moderation bot. This bot uses the xmppjs-chat-bot package.\nNote: we include the MUC domain (room.instance.tld) in the dirname in case the instance domain changes. In such case, existing rooms could get lost, and we want a way to ignore them to avoid gettings errors.\nbot/muc_domain/moderation.json The bot/muc_domain/moderation.json file contains the moderation bot global configuration. This bot uses the xmppjs-chat-bot package, see it\u0026rsquo;s README file for more information.\nNote: this includes the bot username and password. Don\u0026rsquo;t let it leak.\nbot/muc_domain/rooms The bot/muc_domain/rooms folder contains room configuration files. See the xmppjs-chat-bot package help for more information.\nemojis/channel The emojis/channel folder contains custom emojis definitions for channels.\nFor example, the channel 1 will contain:\n emojis/channel/1/definition.json: the JSON file containing the emojis definitions emojis/channel/1/files/42.png: N image files (png, jpg, \u0026hellip;), using numbers as filenames.  tokens The tokens folder contains long term token to connect to the chat. See the LivechatProsodyAuth class for more information.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/installation/upgrade_before_6.0.0/","title":"Upgrade from version older than 6.0.0","tags":[],"description":"Important notes when upgrading for an older version.","content":"IMPORTANT NOTE Since version v6.0.0, this plugin does not need any Prosody installation.\nIf you were using this plugin before this version, and if you had installed Prosody manually, you can safely uninstall Prosody.\nIf you were using the custom Peertube docker image that is embedding Prosody, you can switch back to the official Peertube image.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/admin/advanced/matterbridge/","title":"Using Matterbridge","tags":[],"description":"Using Matterbridge to bridge with other chats","content":"The following is based on a tutorial to use Matterbridge with the plugin: Matterbridge + Peertube\nRequirements  PeerTube plugin livechat version 3.2.0 or later. Matterbridge version 1.22.4 or later.  The easiest is if the PeerTube instance and Matterbridge run on the same server.\nInternal connections only (basic) You will need to enable Enable client to server connections in the livechat plugin settings.\nThis will allow localhost XMPP clients to connect to the Prosody XMPP server.\nYou may need to add some line to your /etc/hosts:\n127.0.0.1 anon.example.org room.example.org Replace example.org by your actual instance domain name. Afterwards you can continue with the Matterbridge configuration below.\nAllow external connections (advanced) By default, the internal Prosody XMPP server only listens on localhost (127.0.0.1).\nOn livechat versions \u0026gt;= 10.1.0 a new option call Client to server network interfaces was added to allow changing this.\nIt allows to add a list of IPs to listen on, coma separated (spaces will be stripped).\nYou can also use * to listen on all IPv4 interfaces, and :: for all IPv6. Doing so allows external access to the client to server interface.\nThen you need to open the C2S port (by default 52822, but check the plugin settings to get the current value) in your firewall so that it can be reached from the internet. If you don\u0026rsquo;t want to use C2S connections for anything else than your Matterbridge service, you should restrict access to this port to your Matterbridge server IP.\nYou also need to add DNS records (A and AAAA) for anon.example.org and room.example.org (replace example.org by your actual domain name).\nIn case you are using a port other than 5222 (XMPP standard port) you also need to set the xmpp-client SRV record to the correct port.\nConfigurating Matterbridge In the version 1.22.4, Matterbridge added support for XMPP anonymous connections needed to connect to the built-in prosody.\nSo in the TOML config file put:\n[xmpp.mypeertube] Anonymous=true Server=\u0026#34;anon.example.org:52822\u0026#34; Muc=\u0026#34;room.example.org\u0026#34; Nick=\u0026#34;Matterbridge\u0026#34; RemoteNickFormat=\u0026#34;[{PROTOCOL}] \u0026lt;{NICK}\u0026gt; \u0026#34; NoTLS=true  Replace example.org by your actual instance domain name. Replace 52822 by the actual port if you changed it. mypeertube can be replaced by another name. Using peertube as the Nick will provide put PeerTube icon for overlay messages, can be also done with overlay config modification. The setting NoTLS=true allows connecting to a server with self-signed certificates.  Now you can add this account to gateways and bridge specific live-chat channels.\nThis documentation use an anonymous account to connect the bridge to the chat. But since the livechat v10.1.0, there is a new way to generate long term authentication token, that allows to connect using your account. This is used for OBS docks. Using this feature for other purposes is not documented and not officially supported yet. If you want to use it anyway, you can request a token by calling then /plugins/livechat/router/api/auth/tokens endpoint. To get needed headers and request body, just check what happens when you generate a new token for OBS docks.\n "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/contributing/","title":"Contributing","tags":[],"description":"Contributing","content":"Interested in contributing? Awesome!\n Code of Conduct  Contributor Covenant Code of Conduct\n   Translate  Translate the plugin\n   Give your feedback  Give your feedback\n   Develop  Develop\n   Documentation  Document the plugin, or translate the documentation.\n   "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/technical/slow_mode/","title":"MUC Slow mode","tags":[],"description":"MUC Slow mode XEP","content":"The livechat plugin includes a \u0026ldquo;slow mode\u0026rdquo; feature, to rate limit the number of messages that a user can send to a given MUC room. At time of writing, there were no XEP to describe such feature. Please find below a XEP draft, that will be submitted for review.\nWork In Progress, this page is not done yet. For an updated version of this document, you can check the draft XEP XMP file.\n XEP: MUC Slow Mode Abstract: This specification describes a way to rate limit messages a single user can send to a MUC room, from the room configuration to the server and client handling of such a feature.\nAuthor: John Livingston\n1. Introduction There are some contexts in which you want to be able to rate limit MUC messages. This could have multiple motivations: avoid flooding, garantee a better readability of the room when there are hundreds of active users, \u0026hellip;\nThis specification propose a new option to MUC rooms, allowing room owners to fix a duration that users MUST wait between two messages. We will also specify how the server MUST reject messages send too quickly, and how clients SHOULD handle this feature (by preventing users to send messages without waiting the delay to be over).\n2. Terminology Clients: the client software used by end-users to join MUC rooms.\nModerator: A room role that is usually associated with room admins but that can be granted to non-admins.\nMUC: The multi-user chat protocol for text-based conferencing.\nParticipant: An occupant who does not have admin status; in a moderated room, a participant is further defined as having voice (in contrast to a visitor). A participant has a role of \u0026ldquo;participant\u0026rdquo;.\nRole: A temporary position or privilege level within a room, distinct from a user\u0026rsquo;s long-lived affiliation with the room; the possible roles are \u0026ldquo;moderator\u0026rdquo;, \u0026ldquo;participant\u0026rdquo;, and \u0026ldquo;visitor\u0026rdquo; (it is also possible to have no defined role). A role lasts only for the duration of an occupant\u0026rsquo;s visit to a room. See XEP-0045.\nRoom administrator: A user empowered by the room owner to perform administrative functions such as banning users; however, a room administrator is not allowed to change the room configuration or to destroy the room. An admin has an affiliation of \u0026ldquo;admin\u0026rdquo;. See XEP-0045.\nRoom owner: users that have special access to a room, and that can edit room configuration. See XEP-0045 - Owner Use Cases.\nService Discovery Extensions: XEP-0128: Service Discovery Extensions.\nSlow Mode: feature allowing to rate limit user messages in a MUC room.\nSlow Mode duration: when the Slow Mode feature is active, specifies the duration, in seconds, users must wait between two text messages.\n3. Requirements This document addresses the following requirements:\n How to allow room owners to enable and configure the feature by editing the MUC room discovery information. How to enable and configure the feature without allowing room owners to change the configuration. How the server MUST reject messages that does not respect the parameters. How clients SHOULD handle rooms with such feature enabled.  4. MUC configuration 4.1 Activating Slow Mode in the MUC Room configuration Your implementation MAY allow the Slow Mode feature to be set room by room, by its owners.\nIf room owners can configure the Slow Mode feature, the server MUST add a muc#roomconfig_slow_mode_duration field in the room configuration form.\nThis field MUST have its type equal to text-single.\nThis field SHOULD use Data Forms Validation, having its datatype equal to xs:integer.\nThe value of the field MUST be a positive integer, so you MUST add a range validation, as described in RFC-0122.\n0 value means that the slow mode is disabled for this room. Any positive value is the duration, in seconds, users must wait between two messages.\nHere is an example of response the server could send when a client is querying room configuration form:\n\u0026lt;iq from=\u0026#39;coven@chat.shakespeare.lit\u0026#39; id=\u0026#39;config1\u0026#39; to=\u0026#39;crone1@shakespeare.lit/desktop\u0026#39; type=\u0026#39;result\u0026#39;\u0026gt; \u0026lt;query xmlns=\u0026#39;http://jabber.org/protocol/muc#owner\u0026#39;\u0026gt; \u0026lt;x xmlns=\u0026#39;jabber:x:data\u0026#39; type=\u0026#39;form\u0026#39;\u0026gt; \u0026lt;title\u0026gt;Configuration for \u0026#34;coven\u0026#34; Room\u0026lt;/title\u0026gt; \u0026lt;instructions\u0026gt; Complete this form to modify the configuration of your room. \u0026lt;/instructions\u0026gt; \u0026lt;field type=\u0026#39;hidden\u0026#39; var=\u0026#39;FORM_TYPE\u0026#39;\u0026gt; \u0026lt;value\u0026gt;http://jabber.org/protocol/muc#roomconfig\u0026lt;/value\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;field var=\u0026#39;muc#roomconfig_slow_mode_duration\u0026#39; type=\u0026#39;text-single\u0026#39; label=\u0026#39;Slow Mode (0=disabled, any positive integer= users can send a message every X seconds.)\u0026#39; \u0026gt; \u0026lt;validate xmlns=\u0026#39;http://jabber.org/protocol/xdata-validate\u0026#39; datatype=\u0026#39;xs:integer\u0026#39;\u0026gt; \u0026lt;range min=\u0026#39;0\u0026#39;/\u0026gt; \u0026lt;/validate\u0026gt; \u0026lt;value\u0026gt;20\u0026lt;/value\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;!-- and any other field... --\u0026gt; \u0026lt;/x\u0026gt; \u0026lt;/query\u0026gt; \u0026lt;/iq\u0026gt; If the configuration is changed, the server SHOULD send a status code 104, as specified in XEP-0045 - Notification of configuration changes.\n4.2 Client discovering The feature can be enabled on a room:\n by the room owner, if your implementation allow them to set this option by a server-wide parameter  In other words: you can enable this feature, without adding the field in the room configuration form. This allows for example server admins to apply a rate limit server-wide, or to set the slow mode programmatically on any wanted criteria (number of users in the room, current server load, room context, \u0026hellip;).\nIn any case, to allow clients to discover that the feature is active, the server MUST respond on room information queries by adding a muc#roominfo_slow_mode_duration field. This field type MUST be text-single, and its value MUST be a positive integer.\n0 value means that the slow mode is disabled for this room. Any positive value is the duration, in seconds, users must wait between two messages. Any invalid (non-positive integer) value sent by the server MUST be considered as equal to 0 (in case of a bad implementation).\nHere is an example of response the server could send when a client is querying room information:\n\u0026lt;iq from=\u0026#39;coven@chat.shakespeare.lit\u0026#39; id=\u0026#39;ik3vs715\u0026#39; to=\u0026#39;hag66@shakespeare.lit/pda\u0026#39; type=\u0026#39;result\u0026#39;\u0026gt; \u0026lt;query xmlns=\u0026#39;http://jabber.org/protocol/disco#info\u0026#39;\u0026gt; \u0026lt;identity category=\u0026#39;conference\u0026#39; name=\u0026#39;The place to be\u0026#39; type=\u0026#39;text\u0026#39;/\u0026gt; \u0026lt;feature var=\u0026#39;http://jabber.org/protocol/muc\u0026#39;/\u0026gt; \u0026lt;x xmlns=\u0026#39;jabber:x:data\u0026#39; type=\u0026#39;result\u0026#39;\u0026gt; \u0026lt;field var=\u0026#39;FORM_TYPE\u0026#39; type=\u0026#39;hidden\u0026#39;\u0026gt; \u0026lt;value\u0026gt;http://jabber.org/protocol/muc#roominfo\u0026lt;/value\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;field var=\u0026#39;muc#roominfo_slow_mode_duration\u0026#39; type=\u0026#39;text-single\u0026#39;\u0026gt; \u0026lt;value\u0026gt;2\u0026lt;/value\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;!-- and any other field... --\u0026gt; \u0026lt;/x\u0026gt; \u0026lt;/query\u0026gt; \u0026lt;/iq\u0026gt; If the slow mode duration has changed (either because the room configuration was modified, or because a server parameter has changed), the server SHOULD send a status code 104, as specified in XEP-0045 - Notification of configuration changes.\n5. Server-side rate limiting When the Slow Mode is enabled, server MUST NOT accept two consecutive messages from the same user, to the same room, until the slow mode duration has elapsed. Only messages containing at least one \u0026lt;body/\u0026gt; element must be taking into account (to avoid counting chatstate messages for example).\nRoom administrators and owners MUST NOT be rate limited.\nIf a user bypass the limit, the server MUST reply an error stanza, that respects RFC 6120, especially:\n error_type MUST be wait, as described in RFC 6120 - Stanzas error - Syntax, error_condition MUST be policy-violation, as described in RFC 6120 - Stanzas error - Defined Stream Error Conditions, the stanza SHOULD contain a \u0026lt;text\u0026gt; element explaining why the message was rejected, and this message SHOULD mention the slow mode duration so that user can understand why they can\u0026rsquo;t post their message.  Here is an example or error stanza:\n\u0026lt;message xmlns=\u0026#34;jabber:client\u0026#34; type=\u0026#34;error\u0026#34; to=\u0026#34;crone1@shakespeare.lit/desktop\u0026#34; id=\u0026#34;528df978-aa6b-422a-b987-056a810c4733\u0026#34; from=\u0026#34;coven@chat.shakespeare.lit\u0026#34; \u0026gt; \u0026lt;error type=\u0026#34;wait\u0026#34;\u0026gt; \u0026lt;policy-violation xmlns=\u0026#34;urn:ietf:params:xml:ns:xmpp-stanzas\u0026#34; /\u0026gt; \u0026lt;text xmlns=\u0026#34;urn:ietf:params:xml:ns:xmpp-stanzas\u0026#34;\u0026gt; You have exceeded the limit imposed by the slow mode in this room. You have to wait 2 seconds between messages. Please try again later \u0026lt;/text\u0026gt; \u0026lt;/error\u0026gt; \u0026lt;/message\u0026gt; 6. Client handling When a participant joins a room, the client SHOULD request room information as described in section \u0026ldquo;4.2 Client discovering\u0026rdquo;, and look for the muc#roominfo_slow_mode_duration field.\nIf this field is present, and contains a valid strictly positive integer value, the client SHOULD display an information somewhere, to tell users that there is a slow mode limitation that applies to this room. This information MAY also be displayed to users for which the rate limit does not apply (administrators, owners, \u0026hellip;).\nMoreover, each time a participant sends a text message, the client SHOULD prevent the user to send another message before the timeout is passed. This MAY be done either by disabling the input field, or the submit button. If the user has at least the administrator acces level, the client SHOULD NOT disable the input field or the submit button.\nTo avoid some frustrating behaviour, in case there is some lag on the server for example, the client MAY start counting time after receiving the message echo. Indeed, if the first message is processed with some delay by the server, it could consider that the duration is not passed yet when receiving the next one.\n7. Security Considerations As a same user can join a room with multiple sessions and/or nicknames, the server MUST use the appropriate key to identify the account, and apply the same limits to all user\u0026rsquo;s sessions.\nAppendices Appendix A: Document information TO BE DONE\nAppendix B: Author Information John Livingston\nWebsite: https://www.john-livingston.fr\nAppendix C: Legal Notices TO BE DONE\nAppendix D: Relation to XMPP The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 6120) and XMPP IM (RFC 6121) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.\nAppendix E: Discussion Venue TO BE DONE\nAppendix F: Requirements Conformance The following requirements keywords as used in this document are to be interpreted as described in RFC 2119: \u0026ldquo;MUST\u0026rdquo;, \u0026ldquo;SHALL\u0026rdquo;, \u0026ldquo;REQUIRED\u0026rdquo;; \u0026ldquo;MUST NOT\u0026rdquo;, \u0026ldquo;SHALL NOT\u0026rdquo;; \u0026ldquo;SHOULD\u0026rdquo;, \u0026ldquo;RECOMMENDED\u0026rdquo;; \u0026ldquo;SHOULD NOT\u0026rdquo;, \u0026ldquo;NOT RECOMMENDED\u0026rdquo;; \u0026ldquo;MAY\u0026rdquo;, \u0026ldquo;OPTIONAL\u0026rdquo;.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/xmpp_clients/","title":"XMPP Clients","tags":[],"description":"Connect to chat using a XMPP client","content":"This chat plugin relies on the XMPP protocol (also known as Jabber). It is therefore possible to connect to the chats using XMPP client software. This can be useful for example to facilitate moderation operations.\nThe features described on this page must be enabled and configured by your Peertube instance\u0026rsquo;s administrators. You may therefore not have access to them.\n Login to your Peertube account This feature is not yet available, and will come in a future version of the plugin.\n Connection using an external XMPP account If this feature is enabled on your instance, you can connect to Peertube chats using any XMPP account.\nTo get the address of the room you want to join, you can use the \u0026ldquo;share chat\u0026rdquo; button that is located above the chat:\nBy default, the share button is only visible to the owner of the video, and the admins/moderators of the instance. However, admins can decide to display this button for everyone.\n Then, choose \u0026ldquo;Connect using XMPP\u0026rdquo;:\nThen you just have to click on \u0026ldquo;open\u0026rdquo; or copy/paste the address of the chat room into your XMPP client (using the \u0026ldquo;join a room\u0026rdquo; feature).\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/technical/polls/","title":"Polls","tags":[],"description":"Polls technical documentation","content":"The poll system relies on two thinks:\n mod_muc_polls Prosody module on the backend polls Converse plugin on the frontend  Backend mod_muc_polls is a Prosody modules that implements polls in MUC. This module could be used on any Prosody server, and has no code specific to the livechat plugin.\nThe way this module works could be standardized one day, by writing a XEP.\nPoll creation This module adds the http://jabber.org/protocol/muc#x-poll disco features on muc-disco#info.\nRoom\u0026rsquo;s owner and admin can retrieve a http://jabber.org/protocol/muc#x-poll form by sending the relevant iq query. This forms contains relevant fields (the poll question, the duration, choices, \u0026hellip;). Once the form submitted, a new poll is created. Any previous existing poll will end (if not already ended).\nThe current poll is stored in room._data.current_poll.\nFor now, any ended poll is not kept.\nPoll starts When a poll is started, a groupchat message is broadcasted in the MUC room. This message is sent in the name of the poll creator (same from, same occupant-id). This message contains the question, the different choices, and some instructions (in english).\nThis message also contains some specific XML tags. These tags could be use by any compatible client to display the poll as they want.\nHere an Example of this start message:\n\u0026lt;message id=\u0026#39;25Plgjj2TdemFuomNuKZ9bxRQFLbiVHwc8_4\u0026#39; to=\u0026#39;root@p1.localhost/converse.js-117702469\u0026#39; xmlns=\u0026#39;jabber:client\u0026#39; from=\u0026#39;5dd144b2-3c24-4cbc-a34e-143e951ecf50@room.p1.localhost/Root\u0026#39; type=\u0026#39;groupchat\u0026#39;\u0026gt; \u0026lt;body\u0026gt;The poll question 1: Choice 1 label 2: Choice 2 label Send a message with an exclamation mark followed by your choice number to vote. Example: !1 \u0026lt;/body\u0026gt; \u0026lt;occupant-id id=\u0026#39;yoXY0/DaHd03MpGsc+ayjEFZ5UIWt6JmrxC+6HPz4qM=\u0026#39; xmlns=\u0026#39;urn:xmpp:occupant-id:0\u0026#39;/\u0026gt; \u0026lt;x-poll id=\u0026#39;_eZQ4j4YLHTK\u0026#39; xmlns=\u0026#39;http://jabber.org/protocol/muc#x-poll-message\u0026#39; end=\u0026#39;1720177157\u0026#39; votes=\u0026#39;0\u0026#39;\u0026gt; \u0026lt;x-poll-question\u0026gt;The poll question\u0026lt;/x-poll-question\u0026gt; \u0026lt;x-poll-choice choice=\u0026#39;1\u0026#39; votes=\u0026#39;0\u0026#39;\u0026gt;Choice 1 label\u0026lt;/x-poll-choice\u0026gt; \u0026lt;x-poll-choice choice=\u0026#39;2\u0026#39; votes=\u0026#39;0\u0026#39;\u0026gt;Choice 2 label\u0026lt;/x-poll-choice\u0026gt; \u0026lt;/x-poll\u0026gt; \u0026lt;stanza-id xmlns=\u0026#39;urn:xmpp:sid:0\u0026#39; id=\u0026#39;dOASuopT9kW5OgAKvhZo0Irm\u0026#39; by=\u0026#39;5dd144b2-3c24-4cbc-a34e-143e951ecf50@room.p1.localhost\u0026#39;/\u0026gt; \u0026lt;/message\u0026gt; Note: the end attribute is the poll end date timestamp. The votes attributes are the number of votes (total on x-poll and per choice on each x-poll-choice tag). The choice attribute is the key to use to vote for this choice (choice='1' can by voted by sending !1).\nPoll votes Users can then vote by sending messages in the room, using the format \u0026ldquo;!1\u0026rdquo;.\nThese groupchat messages will be intercepted by the module, and counted as votes.\nIf the \u0026ldquo;anonymous votes\u0026rdquo; feature is enabled, vote will be taken into account, but the message will be bounced with an error saying: \u0026ldquo;Your vote is taken into account. Votes are anonymous, they will not be shown to other participants.\u0026rdquo;\nThis means that you can vote with any XMPP clients!\nIf an occupant votes multiple times, their vote will be updated.\nIf an occupant is muted (has visitor role), votes won\u0026rsquo;t be counted.\nWhen there are new votes, messages are broadcated so that compatible clients can update the current vote progress. These messages are debounced: the module waits 5 seconds after a vote to send the update message, and only send one for all votes that were done in those 5 seconds. These messages are groupchat message without body, and with some specific urn:xmpp:hints. They contains the x-poll tag with same meta data as above. The message is also sent as the poll creator (from and occupant-id).\nHere is an example:\n\u0026lt;message id=\u0026#39;jm9dsXD73eXxlAP2M4dOhay7oXBlQb91LVBf\u0026#39; to=\u0026#39;root@p1.localhost/converse.js-117702469\u0026#39; xmlns=\u0026#39;jabber:client\u0026#39; from=\u0026#39;5dd144b2-3c24-4cbc-a34e-143e951ecf50@room.p1.localhost/Root\u0026#39; type=\u0026#39;groupchat\u0026#39;\u0026gt; \u0026lt;occupant-id id=\u0026#39;yoXY0/DaHd03MpGsc+ayjEFZ5UIWt6JmrxC+6HPz4qM=\u0026#39; xmlns=\u0026#39;urn:xmpp:occupant-id:0\u0026#39;/\u0026gt; \u0026lt;no-copy xmlns=\u0026#39;urn:xmpp:hints\u0026#39;/\u0026gt; \u0026lt;no-store xmlns=\u0026#39;urn:xmpp:hints\u0026#39;/\u0026gt; \u0026lt;no-permanent-store xmlns=\u0026#39;urn:xmpp:hints\u0026#39;/\u0026gt; \u0026lt;x-poll id=\u0026#39;06yCKW_hoZSx\u0026#39; xmlns=\u0026#39;http://jabber.org/protocol/muc#x-poll-message\u0026#39; end=\u0026#39;1720177925\u0026#39; votes=\u0026#39;1\u0026#39;\u0026gt; \u0026lt;x-poll-question\u0026gt;The poll question\u0026lt;/x-poll-question\u0026gt; \u0026lt;x-poll-choice choice=\u0026#39;1\u0026#39; votes=\u0026#39;1\u0026#39;\u0026gt;Choice 1 label\u0026lt;/x-poll-choice\u0026gt; \u0026lt;x-poll-choice choice=\u0026#39;2\u0026#39; votes=\u0026#39;0\u0026#39;\u0026gt;Choice 2 label\u0026lt;/x-poll-choice\u0026gt; \u0026lt;/x-poll\u0026gt; \u0026lt;/message\u0026gt; Note: Standards XMPP clients won\u0026rsquo;t be able to show the progress.\nWhen a user joins the MUC, a similar message will be sent to this user (and this user only, to the new occupant session to be more specific). This is done so that any compatible client can immediatly show the poll.\nNote: clients should ignored x-poll data from archived messages, and only consider data coming from unarchived messages. Otherwise they could show some outdated data.\nPoll end When the poll ends, a new groupchat message is broadcasted in the room.\nHere is an example:\n\u0026lt;message id=\u0026#39;GVqv1YcwI0GZb0myKhmtEqRa9fvWlCbDdF7R\u0026#39; to=\u0026#39;root@p1.localhost/converse.js-117702469\u0026#39; xmlns=\u0026#39;jabber:client\u0026#39; from=\u0026#39;5dd144b2-3c24-4cbc-a34e-143e951ecf50@room.p1.localhost/Root\u0026#39; type=\u0026#39;groupchat\u0026#39;\u0026gt; \u0026lt;body\u0026gt;The poll question This poll is now over. 1: Choice 1 label 2: Choice 2 label \u0026lt;/body\u0026gt; \u0026lt;occupant-id id=\u0026#39;yoXY0/DaHd03MpGsc+ayjEFZ5UIWt6JmrxC+6HPz4qM=\u0026#39; xmlns=\u0026#39;urn:xmpp:occupant-id:0\u0026#39;/\u0026gt; \u0026lt;x-poll id=\u0026#39;_eZQ4j4YLHTK\u0026#39; votes=\u0026#39;5\u0026#39; xmlns=\u0026#39;http://jabber.org/protocol/muc#x-poll-message\u0026#39; end=\u0026#39;1720177157\u0026#39; over=\u0026#39;\u0026#39; \u0026gt; \u0026lt;x-poll-question\u0026gt;The poll question\u0026lt;/x-poll-question\u0026gt; \u0026lt;x-poll-choice choice=\u0026#39;1\u0026#39; votes=\u0026#39;3\u0026#39;\u0026gt;Choice 1 label\u0026lt;/x-poll-choice\u0026gt; \u0026lt;x-poll-choice choice=\u0026#39;2\u0026#39; votes=\u0026#39;2\u0026#39;\u0026gt;Choice 2 label\u0026lt;/x-poll-choice\u0026gt; \u0026lt;/x-poll\u0026gt; \u0026lt;stanza-id xmlns=\u0026#39;urn:xmpp:sid:0\u0026#39; id=\u0026#39;CwiijSxawB8QOP4NN-Li6jP0\u0026#39; by=\u0026#39;5dd144b2-3c24-4cbc-a34e-143e951ecf50@room.p1.localhost\u0026#39;/\u0026gt; \u0026lt;/message\u0026gt; Please note the over attributes that indicated that the poll is over.\nIf users are voting just after the poll ends (less than 30 seconds after the poll end), and the vote is anonymous, their votes will be bounced, to avoid leaking votes for late users.\nSecurity Following tags will be stripped of any incoming groupchat message: x-poll, x-poll-question, x-poll-choice. This is to avoid any poll spoofing.\nFronted The poll Converse plugin does multiple things.\nIt checks for the http://jabber.org/protocol/muc#x-poll disco feature to show the \u0026ldquo;create poll\u0026rdquo; button.\nIt uses standards XMPP forms to get the poll creation form and submit it.\nIt uses the parseMUCMessage hook to check if messages have x-poll data.\nIf so, and if message are not archived, it creates or updates the poll banner.\nWhen clicking on a choice in the banner, it just sends a message in the chat (\u0026quot;!1\u0026quot; for example).\nAs the backend does no localization, it also translate on the fly the english sentences coming from the backend (in the form definition, in poll start/end message, and in bounce/error messages).\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/technical/terms/","title":"Terms&amp;Conditions","tags":[],"description":"Terms&amp;Conditions implementation","content":"You can set terms \u0026amp; conditions on the instance level (called \u0026ldquo;global terms\u0026rdquo;), or at the streamers' channels level (called \u0026ldquo;muc terms\u0026rdquo;, as it is related to muc rooms).\nBackend The mod_muc_peertubelivechat_terms prosody modules handles the terms configuration.\nIt has a configuration option for the global terms. It also adds muc terms in the room data.\nWhen a new occupant session is opened, this modules sends him messages containing the global and muc terms (if set).\nHere is an example of sent messages:\n\u0026lt;message xmlns=\u0026#34;jabber:client\u0026#34; id=\u0026#34;_iRSEs061gi5GBjF7zGh7f-M\u0026#34; type=\u0026#34;groupchat\u0026#34; to=\u0026#34;root@p1.localhost/QH1H89H1\u0026#34; from=\u0026#34;8df24108-6e70-4fc8-b1cc-f2db7fcdd535@room.p1.localhost/Peertube\u0026#34;\u0026gt; \u0026lt;body\u0026gt;The global terms.\u0026lt;/body\u0026gt; \u0026lt;x-livechat-terms type=\u0026#34;global\u0026#34; /\u0026gt; \u0026lt;delay xmlns=\u0026#34;urn:xmpp:delay\u0026#34; stamp=\u0026#34;2024-06-25T11:02:25Z\u0026#34; /\u0026gt; \u0026lt;stanza-id by=\u0026#34;8df24108-6e70-4fc8-b1cc-f2db7fcdd535@room.p1.localhost\u0026#34; xmlns=\u0026#34;urn:xmpp:sid:0\u0026#34; id=\u0026#34;InoL5fonvOoR8X9gOlAYsz_N\u0026#34; /\u0026gt; \u0026lt;no-copy xmlns=\u0026#39;urn:xmpp:hints\u0026#39;/\u0026gt; \u0026lt;no-store xmlns=\u0026#39;urn:xmpp:hints\u0026#39;/\u0026gt; \u0026lt;no-permanent-store xmlns=\u0026#39;urn:xmpp:hints\u0026#39;/\u0026gt; \u0026lt;/message\u0026gt; \u0026lt;message xmlns=\u0026#34;jabber:client\u0026#34; id=\u0026#34;_iRSEs061gi5GBjF7zGh7f-M\u0026#34; type=\u0026#34;groupchat\u0026#34; to=\u0026#34;root@p1.localhost/QH1H89H1\u0026#34; from=\u0026#34;8df24108-6e70-4fc8-b1cc-f2db7fcdd535@room.p1.localhost/Peertube\u0026#34;\u0026gt; \u0026lt;body\u0026gt;The muc terms.\u0026lt;/body\u0026gt; \u0026lt;x-livechat-terms type=\u0026#34;muc\u0026#34; /\u0026gt; \u0026lt;delay xmlns=\u0026#34;urn:xmpp:delay\u0026#34; stamp=\u0026#34;2024-06-25T11:02:25Z\u0026#34; /\u0026gt; \u0026lt;stanza-id by=\u0026#34;8df24108-6e70-4fc8-b1cc-f2db7fcdd535@room.p1.localhost\u0026#34; xmlns=\u0026#34;urn:xmpp:sid:0\u0026#34; id=\u0026#34;InoL5fonvOoR8X9gOlAYsz_N\u0026#34; /\u0026gt; \u0026lt;no-copy xmlns=\u0026#39;urn:xmpp:hints\u0026#39;/\u0026gt; \u0026lt;no-store xmlns=\u0026#39;urn:xmpp:hints\u0026#39;/\u0026gt; \u0026lt;no-permanent-store xmlns=\u0026#39;urn:xmpp:hints\u0026#39;/\u0026gt; \u0026lt;/message\u0026gt; Notice the x-livechat-terms tag.\nStandard XMPP clients will show these messages as standard message.\nMessage are sent from a \u0026ldquo;service nickname\u0026rdquo;: this occupant does not exist. The service nickname is an option of the module (livechat use \u0026ldquo;Peertube\u0026rdquo;, hard coded for now). This nickname is reserved, no-one can spoof it (the module will bounce any request to use this nickname). We must do so, because without nickname, some XMPP clients won\u0026rsquo;t show the messages (tested with Gajim).\nWe also add a delay tag, to trick the moderation bot (see comments in code). This also ensure clients will not drop the message because there is no occupant with this name.\nWe also add some urn:xmpp:hints to avoid storing or copying these messages.\nWhen muc terms are updated, the new terms will be broadcasted.\nTo avoid anyone spoofing terms \u0026amp; conditions, incoming message stanza are filtered, and any x-livechat-terms tag will be removed.\nMessage history is disabled for message containing the x-livechat-terms, so that messages broadcasted when the terms change are not stored by muc_mam modume (\u0026ldquo;Message Archiving Management\u0026rdquo;).\nFrontend For standard XMPP clients, terms will be shown as delayed messages.\nFor the livechat frontend, there is a livechat-converse-terms Converse plugin that will intercept these messages, and prevent them to be shown in the chat history.\nIt will also create infobox at the top of the chat to display the terms content. If muc terms are updated, the new terms will be shown.\nUsers can hide the terms. To remember that a user has already hidden the terms, we store the content in localStorage. We will only show terms again if the content in this localStorage changes. We do so for both global terms and muc terms, in two separate localStorage keys. The keys in localstorage does not depends on the room JID or the origin peertube instance. This means that message will be shown again:\n if terms are modified if the user switch to another channel if the user switch to a video from a different peertube instance  "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/issues/","title":"Bug tracking &amp; new features","tags":[],"description":"Bug tracking / New features requests","content":"If you have new feature requests, bugs, or difficulties to setup the plugin, you can use the Github issue tracker. If possible, try using english or french.\nTo have a glimpse to the roadmap for upcoming features, please refer to:\n this github project. the milestones on github.  If you are a webdesigner or a ConverseJS/Prosody/XMPP expert, and want to help improve this plugin, you are welcome.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/technical/tasks/","title":"Tasks overview","tags":[],"description":"Task Application technical overview","content":"The livechat plugin includes a Task Application. The present document describes how this is implemented.\nBasics This features relies on XEP-0060: Publish-Subscribe. This XEP provide a way to store and retrieve items, and to receive push notifications when an item is created/deleted/modified.\nThere is a Prosody Module, mod_pubsub_peertubelivechat, to implement some specific use of the pubsub mechanism.\nWe use the JID+NodeID addressing to specify some nodes related to each MUC room. The JID is the MUC room JID, the NodeID is functionnality we want to address. For now, this modules only implement one such node: \u0026ldquo;livechat-tasks\u0026rdquo;, to handle tasks and task lists. But the module code anticipates futur uses.\nThe \u0026ldquo;livechat-tasks\u0026rdquo; node contains two type of objects: Task and TaskList (XML Namespaces: urn:peertube-plugin-livechat:tasklist and urn:peertube-plugin-livechat:task). Tasks have an attribute containing their task list id.\nOn the front-end, we have the livechat-converse-tasks plugin for ConverseJS.\nWorkflow Here is the basic workflow used to subscribe to tasks/task-lists, and receive existing items.\n the browsers connect to the chat, and ConverseJS uses the XMPP discovery to get the room features. mod_pubsub_peertubelivechat declares two features: urn:peertube-plugin-livechat:tasklist and urn:peertube-plugin-livechat:task. the browsers detect these feature, and checks that the user has admin or owner affiliation on the MUC component. if not, won\u0026rsquo;t display the Task Application, and stops here. if yes, we will continue: display the Task Application. Create a new PubSubManager object, that will subscribe to the pubsub node. The backend receives the subscription request, test user rights (must be owner/admin on the MUC), and adds the user to the subscribers. Note: a user with multiple browsers tabs will send multiple subscription requests, but this is not an issue. If the node did not exist, the backend automatically created it, and use the MUC name to create a first task-list with that name. Once subscribed, the frontend will request all current entries. The backend tests rights, and send all node entries. On the frontend, the PubSubManager handles the response by dispatching received items to the correct frontend component.  Note: on the backend side, we subscribe all users with the \u0026ldquo;publisher\u0026rdquo; affiliation level. This allows them to publish items, but not change the node configuration.\nHere is the worflow to create/modify/delete items:\n the frontend send a publish request. backend checks rights. backend sends notifications to all subscribers, including the current users. On the front-end PubSubManager receives the notification, and dispatch it to the relevant component.  Unsubscribing When users leaves a MUC room, they are automatically unsubscribed from the \u0026ldquo;livechat-tasks\u0026rdquo; node related to this room.\nWhen users lose the owner/admin affiliation, they are removed from the \u0026ldquo;livechat-tasks\u0026rdquo; node subscriptions.\nItems Here we describes the content of node items.\nTask lists  Item tag: tasklist XML Namespace: urn:peertube-plugin-livechat:tasklist item childs:  name: the text content is the task list name    Example: here is an example of IQ stanza to create a task-list item.\n\u0026lt;iq from=\u0026#34;user@example.com\u0026#34; id=\u0026#34;45cf7543-67bf-4d03-bb5d-a55038a0512a:sendIQ\u0026#34; to=\u0026#34;035fcc4b-072f-4827-b296-6998b04e3456@room.example.com\u0026#34; type=\u0026#34;set\u0026#34; xmlns=\u0026#34;jabber:client\u0026#34; \u0026gt; \u0026lt;pubsub xmlns=\u0026#34;http://jabber.org/protocol/pubsub\u0026#34;\u0026gt; \u0026lt;publish node=\u0026#34;livechat-tasks\u0026#34;\u0026gt; \u0026lt;item\u0026gt; \u0026lt;tasklist xmlns=\u0026#34;urn:peertube-plugin-livechat:tasklist\u0026#34;\u0026gt; \u0026lt;name\u0026gt;Task List Name\u0026lt;/name\u0026gt; \u0026lt;/tasklist\u0026gt; \u0026lt;/item\u0026gt; \u0026lt;/publish\u0026gt; \u0026lt;/pubsub\u0026gt; \u0026lt;/iq\u0026gt; Tasks  Item tag: task XML Namespace: urn:peertube-plugin-livechat:task item attributes:  done: if present and equal to \u0026ldquo;true\u0026rdquo;, means that the task is done list: the list id order: the order of the task in the task list   item childs:  name: the text content is the task name description: the text content is the task description    Example: here is an example of IQ stanza to create a task-list item.\n\u0026lt;iq from=\u0026#34;user@example.com\u0026#34; id=\u0026#34;9fd9a162-1b6c-4b38-a2a1-2485b34f0d8d:sendIQ\u0026#34; to=\u0026#34;035fcc4b-072f-4827-b296-6998b04e3456@room.example.com\u0026#34; type=\u0026#34;set\u0026#34; xmlns=\u0026#34;jabber:client\u0026#34; \u0026gt; \u0026lt;pubsub xmlns=\u0026#34;http://jabber.org/protocol/pubsub\u0026#34;\u0026gt; \u0026lt;publish node=\u0026#34;livechat-tasks\u0026#34;\u0026gt; \u0026lt;item\u0026gt; \u0026lt;task list=\u0026#34;8302c024-c16e-4fbd-aca7-c94cdb2025de\u0026#34; order=\u0026#34;0\u0026#34; done=\u0026#34;true\u0026#34; xmlns=\u0026#34;urn:peertube-plugin-livechat:task\u0026#34; \u0026gt; \u0026lt;name\u0026gt;The task name\u0026lt;/name\u0026gt; \u0026lt;description\u0026gt;here is the description\u0026lt;/description\u0026gt; \u0026lt;/task\u0026gt; \u0026lt;/item\u0026gt; \u0026lt;/publish\u0026gt; \u0026lt;/pubsub\u0026gt; \u0026lt;/iq\u0026gt; Note: in the above example, we added done=\u0026quot;true\u0026quot; just for the example. Don\u0026rsquo;t add the attribute if you want not the task to be marked as done (or if you want to undone the task).\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/technical/","title":"Technical documentation","tags":[],"description":"Technical documentation","content":"  Source code  Source code organization\n   Third party  Displaying the livechat with 3rd party software.\n   Plugin storage  Data files and folders used on the server\n   MUC Slow mode  MUC Slow mode XEP\n   Polls  Polls technical documentation\n   Terms\u0026amp;Conditions  Terms\u0026amp;Conditions implementation\n   Tasks overview  Task Application technical overview\n   "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/contact/","title":"Contact me","tags":[],"description":"Contact the author","content":"If you have any question, or if you want to talk about this plugin, you can join this XMPP room with any Jabber client: plugin-livechat-support@room.im.yiny.org.\nIf you want to support the project financially, you can contact me by mail at git.[at].john-livingston.fr, or check my Liberapay profile.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/credits/","title":"Credits","tags":[],"description":"Plugin Credits","content":"package.json, COPYRIGHT and LICENSE files contain the license information for this software and its dependencies.\nThe plugin is maintained by John Livingston.\nThanks to David Revoy for his work on Peertube\u0026rsquo;s mascot, Sepia. The character design is under CC-By licence, and the SVG files used to create some logo and avatars in this plugin are GPLv3.0. PNG files are under CC-By licences, and comes from the online Sepia Avatar Generator.\nThanks to Framasoft for making Peertube possible, for the financial support, and for hosting the project translations on their Weblate instance.\nThanks to ritimo for the financial support.\nThanks to Code Lutin and Rétribution Copie Publique for the financial support.\nThanks to NlNet and the NGI0 Entrust fund for the financial support.\nThanks to Octopuce for the financial support.\nAnd thanks to all individual contributors who have made a donation via my liberapay page.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/basics/","title":"Some basics","tags":[],"description":"Some basics about how to setup and use the chat for your live stream","content":"Enabling the chat for you live streams Instance administrators can choose to disable or enable chat in specific cases. Information in this section are only true in the default case.\n When you create or modify a Peertube live, there is a \u0026ldquo;plugin settings\u0026rdquo; tab:\nIn the \u0026ldquo;plugin settings\u0026rdquo; tab, there is a \u0026ldquo;Use chat\u0026rdquo; checkbox. Just check or uncheck it to enable or disable the chat associated to your video.\nThere can be other settings in this tab, depending on plugins installed on your Peertube instance.\n Per channel chat On the instance level, Peertube\u0026rsquo;s administrators can choose if chat rooms are unique per video, or if there will be an unique chat room per channel. Please contact your instance\u0026rsquo;s administrators for more information on how they configure the livechat plugin.\nShare the chat On top of the chat, there is a \u0026ldquo;Share chat link\u0026rdquo; button.\nThis button opens a popup, where you can obtain an url to join the chat. This url can be shared.\nThe \u0026ldquo;Embed\u0026rdquo; tab provide some links to embed the chat in websites, or in your live stream.\nYou can customize some options:\n Read-only: you will only be able to read the chat, not write. This is useful to include the chat content in your live stream (see the OBS documentation). Use current theme colors: if checked, your current theme colors will be added to the url, so that any user that opens the link will have the same color set. Generate an iframe to embed the chat in a website: instead of an url, you will obtain an HTML snippet that you can add to your website to embed the chat.  For more information on the \u0026ldquo;Dock\u0026rdquo; tab, check the OBS documentation.\nIn the \u0026ldquo;Web\u0026rdquo; tab, the provided url opens the chat in the Peertube interface. You can share this link to other users to invite them to join the chat.\nThe \u0026ldquo;Share chat link\u0026rdquo; popup can also contain a \u0026ldquo;Connect using XMPP\u0026rdquo; tab. This will only be available if your instance\u0026rsquo;s administators have enabled an correctly configured this option. Using this option, you can provide a link to join the chat using any XMPP client software. Using such softwares can for example facilitate moderation actions.\nModeration Please refer to the moderation documentation.\nInclude the chat in your video stream Please refer to the OBS documentation.\nChat persistence By default, the chat is persistent. This means that the room content will be kept for a while. User joining will see messages posted before their arrival.\nYou can change the persistence behaviour. Open the chat dropdown menu, and click on \u0026ldquo;Configure\u0026rdquo;.\nThere are several options that can be changed.\nYou can for example set the default and maximum number of messages to return to 0, so that new incomers won\u0026rsquo;t see any previously sent message.\nYou can also uncheck \u0026ldquo;enable archiving\u0026rdquo;: if unchecked, messages will be pruned if the server restarts.\nBy unchecking \u0026ldquo;Persistent\u0026rdquo;, the room will be cleared if there is no more participant.\nDelete the chat content If you want to delete the chat content, open the chat dropdown menu, then click on \u0026ldquo;Destroy\u0026rdquo;. A popup will open, asking a confirmation.\nThe chat will be automatically recreated each time someone tries to join it as long as the video exists, and has the \u0026ldquo;Use chat\u0026rdquo; feature activated.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/channel/","title":"Channel configuration","tags":[],"description":"Peertube channel chatrooms configuration","content":" This feature comes with the livechat plugin version 8.0.0, and can be disabled by your instance\u0026rsquo;s admins.\n In the Peertube left menu, there is a \u0026ldquo;Chatrooms\u0026rdquo; entry:\nThis \u0026ldquo;Chatrooms\u0026rdquo; link takes you to a list of your channels. By clicking on a channel, you will then be able to setup some options for your channels:\nHere you can configure:\n Channel's chat terms \u0026 conditions Mute anonymous users default value The slow mode The chat bot Custom emojis More features to come\u0026hellip;  "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/","title":"For streamers","tags":[],"description":"How to setup the chat for your live stream","content":"  Some basics  Some basics about how to setup and use the chat for your live stream\n   Channel configuration  Peertube channel chatrooms configuration\n   Moderation  Plugin peertube-plugin-livechat advanced moderation features\n   Terms \u0026amp; conditions  Configure channel\u0026#39;s chat terms \u0026amp; conditions\n   Slow mode  Plugin peertube-plugin-livechat slow mode\n   Moderation delay  Plugin peertube-plugin-livechat moderation delay\n   Custom emojis  Plugin peertube-plugin-livechat custom emojis\n   Polls  You can create polls to ask viewers their opinion.\n   Tasks / To-do lists  You can handle tasks and task lists with your moderation team.\n   Chat bot  Chat bot setup\n  Forbidden words  The bot can automatically moderate messages containing forbidden words.\n   Timers  The bot can send periodically some messages.\n   Commands  The bot can respond to several commands.\n    "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/moderation/","title":"Moderation","tags":[],"description":"Plugin peertube-plugin-livechat advanced moderation features","content":" This section is still incomplete.\n This page describes the behaviour of livechat versions \u0026gt;= 10.0.0. There were some changes in the way we manage access rights for Peertube administrators and moderators.\n The chat bot You can use a chat bot, that will help you for moderation. Check the chat bot documentation for more information.\nAccessing moderation tools You can access room settings and moderation tools using the chat dropdown menu at the top of the chat.\nThe video owner will be owner of the chat room. This means he can configure the room, delete it, promote other users as admins, \u0026hellip;\n Starting with livechat v10.0.0, Peertube instance\u0026rsquo;s admins and moderators have no special rights on rooms by default. However, they have a special button available on top of the chat: \u0026ldquo;Become moderator\u0026rdquo;. Clicking this button will give them owner access on the room.\n You can use ConverseJS moderation commands to moderate the room. When you open the chat room in full screen, there will also be a menu with dedicated commands on the top right.\nMute anonymous users This feature comes with the livechat plugin version 10.2.0.\n You can prevent anonymous users to send messages. In such case, only registered users will be able to talk in the chat.\nTo enable or disable this feature, use the chat dropdown menu, open the \u0026ldquo;configure\u0026rdquo; menu. In the form, you will find a \u0026ldquo;Mute anonymous users\u0026rdquo; checkbox.\nAnonymous users won\u0026rsquo;t have the message field, and will see following prompt: \u0026ldquo;Only registered users can send messages.\u0026rdquo;\nWhen this feature is enabled, anonymous users will be assigned the \u0026ldquo;visitor\u0026rdquo; role. You can change their role to \u0026ldquo;participant\u0026rdquo; if you want to allow some of them to talk.\nIf you change the room configuration, all anonymous users will be muted or unmuted.\nYou can choose to enable or disable this feature for new chatrooms on the channel configuration page.\nRoles and affiliations There are several roles that can be assignated to users in chat rooms: owner, moderators, member, \u0026hellip;\nThis section is still incomplete.\n You can promote users as moderators, if you need some help.\nDelete room content You can delete old rooms: join the room, and use the menu on the top to destroy the room.\nInstance moderation As Peertube instance moderator or administrator, you will probably need to check that your users are not behaving badly.\nYou can list all existing chatrooms: in the plugin settings screen, there is a button «List rooms».\nFrom there, you can also promote yourself as room moderator by using the \u0026ldquo;Become moderator\u0026rdquo; button on the right.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/terms/","title":"Terms &amp; conditions","tags":[],"description":"Configure channel&#39;s chat terms &amp; conditions","content":" This feature comes with the livechat plugin version 10.2.0.\n Configuration You can add terms \u0026amp; conditions to your channel. These terms will be shown to all users joining the chat.\nTo configure the terms \u0026amp; conditions, go to the channel configuration page:\nURL in the message will be clickable. You can also do some styling: Message Styling.\nViewers When joining the chat, viewers will see the terms:\nPeertube instance\u0026rsquo;s admin can also set global terms \u0026amp; conditions. If so, these terms will be shown above your channel\u0026rsquo;s terms.\n Anonymous users will only see the terms \u0026amp; conditions once they have chosen their nickname (in other words: once they are able to talk).\n You can change the terms content at any time, it will be instantly updated for all viewers.\nUsers can hide the terms \u0026amp; conditions. When doing so, terms won\u0026rsquo;t be shown again, unless you change the content.\nIf your Peertube instance allows joining chat with XMPP clients, users using such clients will see the terms as chat messages, coming from a \u0026ldquo;Peertube\u0026rdquo; account. When you update terms, they will receive a new message with the update terms content.\n "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/slow_mode/","title":"Slow mode","tags":[],"description":"Plugin peertube-plugin-livechat slow mode","content":" This feature comes with the livechat plugin version 8.3.0.\n Introduction As a streamer, you can choose to rate limit your viewers messages in the chat.\nThis can be really usefull to:\n avoid message flooding avoid unreadable chat if there are many viewers talking  You can set a number of seconds that users will have to wait after sending a message, before sending another.\nThis limitation does not apply to moderators.\nSlow mode option On the channel configuration page, you can set the slow mode option:\nThis value will apply as a default value for all your channel\u0026rsquo;s chatrooms.\nSetting the value to 0 will disable the feature.\nSetting the value to a positive integer will set the period during which users will not be able to post additional messages.\nTo modify the value for an already existing room, just open the room \u0026ldquo;configuration\u0026rdquo; menu (on top of the chat window), and change the slow mode value in the configuration form.\nFor viewers If the slow mode is enabled, users will be informed by a message.\nWhen they send a message, the input field will be disabled for X seconds (where X is the slow mode duration).\nThis limitation does not apply to moderators.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/moderation_delay/","title":"Moderation delay","tags":[],"description":"Plugin peertube-plugin-livechat moderation delay","content":" This feature comes with the livechat plugin version 10.3.0.\n Introduction As a streamer, you can choose to delay messages in the chat, to let some time to moderators to delete messages before they can even be read by other participants.\nWhen this feature is enabled, moderators will see all messages without any delay. Chat participants won\u0026rsquo;t see that their own messages are delayed.\nPlease note that messages sent by moderators will also be delayed, to avoid them to respond to messages that are not even visible by other participants.\nModeration delay option On the channel configuration page, you can set the \u0026ldquo;Moderation delay\u0026rdquo; option:\nThis value will apply as a default value for all your channel\u0026rsquo;s chatrooms.\nSetting the value to 0 will disable the feature.\nSetting the value to a positive integer will set the delay, in seconds, to apply to messages. Please avoid setting the value too high. Ideally it should not exceed a few seconds (4 or 5 seconds for example).\nTo modify the value for an already existing room, just open the room \u0026ldquo;configuration\u0026rdquo; menu (on top of the chat window), and change the moderation delay value in the configuration form.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/emojis/","title":"Custom emojis","tags":[],"description":"Plugin peertube-plugin-livechat custom emojis","content":" This feature comes with the livechat plugin version 10.1.0.\n Channel emojis Streamers can add custom emojis to their channels.\nOn the channel configuration page, open the \u0026ldquo;Channel emojis\u0026rdquo; tab:\nYou can configure custom emojis for your channel. These emojis will be available in the emoji picker. Users can also use them by with their short name (for example by writing \":shortname:\"). You can use emojis in the chat using \":shortname:\". The short name can start and/or end by a colon (:), and only contain alphanumerical characters, underscores and hyphens. It is strongly recommended to start them by a colon, so that users can use autocompletion (by typing \":\" then press TAB). Import / Export On the channel configuration page, there are an \u0026ldquo;Import\u0026rdquo; and an \u0026ldquo;Export\u0026rdquo; button. The \u0026ldquo;Export\u0026rdquo; button generates a file than you can then import on another channel.\nYou can also generate a file to import from any other source (for example you can import your Twitch custom emojis). The file must be a valid JSON file, using the following format:\n[ { \u0026#34;sn\u0026#34;: \u0026#34;:short_name:\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://example.com/image.png\u0026#34; } ] The sn attribute is the short name code. The url attribute can be any image url than your browser can access, or a Data URL representing the file you want to import.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/polls/","title":"Polls","tags":[],"description":"You can create polls to ask viewers their opinion.","content":" This feature comes with the livechat plugin version 10.2.0.\n Create a poll You can create a new poll by using the \u0026ldquo;Create a new poll\u0026rdquo; action in the chat top menu:\nThis poll feature should not be considered as a reliable voting system. It is easy to cheat. There is no mechanism to prevent anonymous users to vote multiple times by just reloading the chat. Votes are never fully anonymous, someone having access to the server could see who voted for what choice.\n Poll form Fill the form fields:\n \u0026ldquo;Question\u0026rdquo;: the question to ask to you viewers \u0026ldquo;Poll duration (in minutes)\u0026rdquo;: the duration for which viewers can vote \u0026ldquo;Anonymous results\u0026rdquo;: if checked, votes won\u0026rsquo;t be publicly visible in the chat \u0026ldquo;Choice N\u0026rdquo;: choices that will be presented to viewers  You must at least fill the two first choices fields.\nOnce you submit the form, the poll will instantly start.\nIf there was a previous unfinished poll, it will end and its result will be shown.\nAccess rights Every room\u0026rsquo;s admins can create a new poll.\nWhen you promote someone as room admin or owner, they gets instant access to the \u0026ldquo;Create a new poll\u0026rdquo; action.\nWhen you remove admin or owner rights to someone, they can\u0026rsquo;t create new poll. But any existing poll will continue until it ends.\nEvery user that is not muted can vote. This means that you can prevent anonymous users to vote by using the \u0026ldquo;Mute anonymous users\u0026rdquo; feature.\nPoll workflow When the polls starts, a first message will be sent in the chat, from the account of the user creating the poll.\nA banner will also appear to show the poll, and will be updated regularly with the current votes.\nViewers can then vote by clicking on their choice, or by sending message like \u0026ldquo;!1\u0026rdquo; in the chat.\nVotes counts will be updated regularly in the banner.\nViewers can change their vote at any time, just by making a new choice. Their precedent choice will be replaced by the new one.\nAnonymous viewers can only vote once they have choosen their nickname.\n If \u0026ldquo;Anonymous results\u0026rdquo; is checked, votes won\u0026rsquo;t be shown to other users. If unchecked, votes will be publicly visible as you will see message like \u0026ldquo;!1\u0026rdquo; in the chat.\nFor viewers using XMPP clients or outdated livechat plugin versions, the banner will not be visible. But they will see the message in the chat and will be able to vote by sending messages with their choices.\n When the poll ends, a new message will be sent in the chat, with the results.\nThe only way to get old polls results is to search for the poll end message in the chat. For now, polls results are not saved by any other means. So don\u0026rsquo;t forget to note polls results if you want to keep them.\n "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/tasks/","title":"Tasks / To-do lists","tags":[],"description":"You can handle tasks and task lists with your moderation team.","content":" This feature comes with the livechat plugin version 10.0.0.\n Introduction The livechat plugin includes a Task Application: a kind of \u0026ldquo;to-do list\u0026rdquo; feature where you can create task lists and add tasks to them. Every room\u0026rsquo;s admins have access to these tasks, so you can edit them collaboratively.\nYou can for example use the Task Application to:\n prepare a list of themes you want to discuss during your livestream, so you can be sure you won\u0026rsquo;t forget anything highlight questions from your viewers, so you can come back to them later without forgetting to answer them \u0026hellip;  Using the Task Application Opening the Task Application To open the Task Application, there is a \u0026ldquo;Tasks\u0026rdquo; button in the top chat menu:\nClicking this button will toggle the Task Application display:\nTo have more space and better readability, open the chat in full-page mode.\n Access rights Every room\u0026rsquo;s admins have access to the Task Application (read and write access).\nWhen you promote someone as room admin or owner, they gets instant access to the Task Application. When you remove admin or owner rights to someone, they instantly lose access to the Task Application.\nTask lists By default, there is one task list that has the same name as your livestream.\nYou can use the form at the bottom to create a new task list. You can also edit existing task lists using the edit button, or delete any task list. Deleting a task list will also delete all its tasks.\nTask lists are sorted alphabetically.\nAll modification are instantly visible in all your browser tabs, and for all room\u0026rsquo;s admins.\n Tasks Create tasks You can create a task using the button on the right of task lists. This opens a form with two fields: a mandatory task name, and an optional description.\nEdit tasks Tasks can be edited by using the edit button on the right.\nTasks can be marked complete (or uncomplete) by clicking directly on the checkbox in the list.\nSorting tasks / change task list You can sort tasks, or move tasks from one list to another, simply using drag \u0026amp; drop.\nCreate a task from a chat message You can create a task from a message in a chat, using the \u0026ldquo;Create a new task\u0026rdquo; button in the dropdown menu at the right of the message. This will open a dialog box where you can choose which task list you want to add the task into. The task name will be the user nickname, and the task description the message content.\nUsing this feature, for example, you can ask your moderators to highlight all chat questions, so you can see them at a glance during your livestream, and check them as answered.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/documentation/user/streamers/bot/","title":"Chat bot","tags":[],"description":"Chat bot setup","content":" This feature comes with the livechat plugin version 8.0.0, and can be disabled by your instance\u0026rsquo;s admins.\n You can enable a chat bot on your chatrooms. The bot configuration is made channel per channel, and will apply to all related videos' chatrooms.\nTo access this page, check the channel configuration documentation.\nOnce there, you can enable the bot, and setup several options:\n Forbidden words  The bot can automatically moderate messages containing forbidden words.\n   Timers  The bot can send periodically some messages.\n   Commands  The bot can respond to several commands.\n   The bot will reload instantly when you save the page.\n"},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/","title":"","tags":[],"description":"","content":"PeerTube plugin livechat You can use the language selector in the left menu to view this documentation in different languages. Some translations are missing or incomplete. In this case, you\u0026rsquo;ll see the English version of the text.\n Welcome the Peertube Livechat Plugin documentation.\nPeertube is a decentralized streaming platform, that can provide both live streaming and VOD (Video On Demand) features. The present plugin adds chatting capatibilities to your Peertube installation, allowing viewers to interract with streamers.\nTo have a glimpse on this plugin capabilities, checkout the introduction. For more precise informations, please find bellow the summary of this documentation.\nYou can use the searchbox in the left menu to quickly find specific documentation parts.\n Before updating to a major release, please read the release notes and breaking changes list : CHANGELOG.\n  Introduction  Introduction\n   Documentation  Plugin documentation\n  User documentation  Plugin peertube-plugin-livechat user documentation\n  For viewers  How to chat for stream viewers\n   OBS  Documentation to stream the chat content using OBS.\n   XMPP Clients  Connect to chat using a XMPP client\n   For streamers  How to setup the chat for your live stream\n  Some basics  Some basics about how to setup and use the chat for your live stream\n Channel configuration  Peertube channel chatrooms configuration\n Moderation  Plugin peertube-plugin-livechat advanced moderation features\n Terms \u0026amp; conditions  Configure channel\u0026#39;s chat terms \u0026amp; conditions\n Slow mode  Plugin peertube-plugin-livechat slow mode\n Moderation delay  Plugin peertube-plugin-livechat moderation delay\n Custom emojis  Plugin peertube-plugin-livechat custom emojis\n Polls  You can create polls to ask viewers their opinion.\n Tasks / To-do lists  You can handle tasks and task lists with your moderation team.\n Chat bot  Chat bot setup\n   Installation guide  Plugin peertube-plugin-livechat installation guide\n  Troubleshooting  Some classic mistakes and workarounds.\n   Known issues: CPU Compatibility  For now, the plugin only works out of the box for x86_64 and arm64 CPU architecture. Here are some instructions for other CPU architectures.\n   Upgrade from version older than 6.0.0  Important notes when upgrading for an older version.\n    Admin documentation  Plugin Peertube Livechat administration\n  Settings  Plugin Peertube Livechat settings\n   External Authentication  Plugin Peertube Livechat settings - External Authentication\n   Advanced usage  Some advanced features\n  XMPP clients  Allow connections using XMPP clients\n Using Matterbridge  Using Matterbridge to bridge with other chats\n    Contributing  Contributing\n  Code of Conduct  Contributor Covenant Code of Conduct\n   Translate  Translate the plugin\n   Give your feedback  Give your feedback\n   Develop  Develop\n   Documentation  Document the plugin, or translate the documentation.\n    Bug tracking \u0026amp; new features  Bug tracking / New features requests\n   Technical documentation  Technical documentation\n  Source code  Source code organization\n   Third party  Displaying the livechat with 3rd party software.\n   Plugin storage  Data files and folders used on the server\n   MUC Slow mode  MUC Slow mode XEP\n   Polls  Polls technical documentation\n   Terms\u0026amp;Conditions  Terms\u0026amp;Conditions implementation\n   Tasks overview  Task Application technical overview\n    Contact me  Contact the author\n   Credits  Plugin Credits\n   "},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/categories/","title":"Categories","tags":[],"description":"","content":""},{"uri":"https://johnxlivingston.github.io/peertube-plugin-livechat/cs/tags/","title":"Tags","tags":[],"description":"","content":""}]